<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8" />
<title>Week3</title>

<style type="text/css">
/*!
 * Bootstrap v3.3.4 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 *//*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{margin:.67em 0;font-size:2em}mark{color:#000;background:#ff0}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{height:0;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;font:inherit;color:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type=checkbox],input[type=radio]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;-webkit-appearance:textfield}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{padding:.35em .625em .75em;margin:0 2px;border:1px solid silver}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */@media print{*,:after,:before{color:#000!important;text-shadow:none!important;background:0 0!important;-webkit-box-shadow:none!important;box-shadow:none!important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="javascript:"]:after,a[href^="#"]:after{content:""}blockquote,pre{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}img,tr{page-break-inside:avoid}img{max-width:100%!important}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}select{background:#fff!important}.navbar{display:none}.btn>.caret,.dropup>.btn>.caret{border-top-color:#000!important}.label{border:1px solid #000}.table{border-collapse:collapse!important}.table td,.table th{background-color:#fff!important}.table-bordered td,.table-bordered th{border:1px solid #ddd!important}}@font-face{font-family:'Glyphicons Halflings';src:url(../fonts/glyphicons-halflings-regular.eot);src:url(../fonts/glyphicons-halflings-regular.eot?#iefix) format('embedded-opentype'),url(../fonts/glyphicons-halflings-regular.woff2) format('woff2'),url(../fonts/glyphicons-halflings-regular.woff) format('woff'),url(../fonts/glyphicons-halflings-regular.ttf) format('truetype'),url(../fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular) format('svg')}.glyphicon{position:relative;top:1px;display:inline-block;font-family:'Glyphicons Halflings';font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.glyphicon-asterisk:before{content:"\2a"}.glyphicon-plus:before{content:"\2b"}.glyphicon-eur:before,.glyphicon-euro:before{content:"\20ac"}.glyphicon-minus:before{content:"\2212"}.glyphicon-cloud:before{content:"\2601"}.glyphicon-envelope:before{content:"\2709"}.glyphicon-pencil:before{content:"\270f"}.glyphicon-glass:before{content:"\e001"}.glyphicon-music:before{content:"\e002"}.glyphicon-search:before{content:"\e003"}.glyphicon-heart:before{content:"\e005"}.glyphicon-star:before{content:"\e006"}.glyphicon-star-empty:before{content:"\e007"}.glyphicon-user:before{content:"\e008"}.glyphicon-film:before{content:"\e009"}.glyphicon-th-large:before{content:"\e010"}.glyphicon-th:before{content:"\e011"}.glyphicon-th-list:before{content:"\e012"}.glyphicon-ok:before{content:"\e013"}.glyphicon-remove:before{content:"\e014"}.glyphicon-zoom-in:before{content:"\e015"}.glyphicon-zoom-out:before{content:"\e016"}.glyphicon-off:before{content:"\e017"}.glyphicon-signal:before{content:"\e018"}.glyphicon-cog:before{content:"\e019"}.glyphicon-trash:before{content:"\e020"}.glyphicon-home:before{content:"\e021"}.glyphicon-file:before{content:"\e022"}.glyphicon-time:before{content:"\e023"}.glyphicon-road:before{content:"\e024"}.glyphicon-download-alt:before{content:"\e025"}.glyphicon-download:before{content:"\e026"}.glyphicon-upload:before{content:"\e027"}.glyphicon-inbox:before{content:"\e028"}.glyphicon-play-circle:before{content:"\e029"}.glyphicon-repeat:before{content:"\e030"}.glyphicon-refresh:before{content:"\e031"}.glyphicon-list-alt:before{content:"\e032"}.glyphicon-lock:before{content:"\e033"}.glyphicon-flag:before{content:"\e034"}.glyphicon-headphones:before{content:"\e035"}.glyphicon-volume-off:before{content:"\e036"}.glyphicon-volume-down:before{content:"\e037"}.glyphicon-volume-up:before{content:"\e038"}.glyphicon-qrcode:before{content:"\e039"}.glyphicon-barcode:before{content:"\e040"}.glyphicon-tag:before{content:"\e041"}.glyphicon-tags:before{content:"\e042"}.glyphicon-book:before{content:"\e043"}.glyphicon-bookmark:before{content:"\e044"}.glyphicon-print:before{content:"\e045"}.glyphicon-camera:before{content:"\e046"}.glyphicon-font:before{content:"\e047"}.glyphicon-bold:before{content:"\e048"}.glyphicon-italic:before{content:"\e049"}.glyphicon-text-height:before{content:"\e050"}.glyphicon-text-width:before{content:"\e051"}.glyphicon-align-left:before{content:"\e052"}.glyphicon-align-center:before{content:"\e053"}.glyphicon-align-right:before{content:"\e054"}.glyphicon-align-justify:before{content:"\e055"}.glyphicon-list:before{content:"\e056"}.glyphicon-indent-left:before{content:"\e057"}.glyphicon-indent-right:before{content:"\e058"}.glyphicon-facetime-video:before{content:"\e059"}.glyphicon-picture:before{content:"\e060"}.glyphicon-map-marker:before{content:"\e062"}.glyphicon-adjust:before{content:"\e063"}.glyphicon-tint:before{content:"\e064"}.glyphicon-edit:before{content:"\e065"}.glyphicon-share:before{content:"\e066"}.glyphicon-check:before{content:"\e067"}.glyphicon-move:before{content:"\e068"}.glyphicon-step-backward:before{content:"\e069"}.glyphicon-fast-backward:before{content:"\e070"}.glyphicon-backward:before{content:"\e071"}.glyphicon-play:before{content:"\e072"}.glyphicon-pause:before{content:"\e073"}.glyphicon-stop:before{content:"\e074"}.glyphicon-forward:before{content:"\e075"}.glyphicon-fast-forward:before{content:"\e076"}.glyphicon-step-forward:before{content:"\e077"}.glyphicon-eject:before{content:"\e078"}.glyphicon-chevron-left:before{content:"\e079"}.glyphicon-chevron-right:before{content:"\e080"}.glyphicon-plus-sign:before{content:"\e081"}.glyphicon-minus-sign:before{content:"\e082"}.glyphicon-remove-sign:before{content:"\e083"}.glyphicon-ok-sign:before{content:"\e084"}.glyphicon-question-sign:before{content:"\e085"}.glyphicon-info-sign:before{content:"\e086"}.glyphicon-screenshot:before{content:"\e087"}.glyphicon-remove-circle:before{content:"\e088"}.glyphicon-ok-circle:before{content:"\e089"}.glyphicon-ban-circle:before{content:"\e090"}.glyphicon-arrow-left:before{content:"\e091"}.glyphicon-arrow-right:before{content:"\e092"}.glyphicon-arrow-up:before{content:"\e093"}.glyphicon-arrow-down:before{content:"\e094"}.glyphicon-share-alt:before{content:"\e095"}.glyphicon-resize-full:before{content:"\e096"}.glyphicon-resize-small:before{content:"\e097"}.glyphicon-exclamation-sign:before{content:"\e101"}.glyphicon-gift:before{content:"\e102"}.glyphicon-leaf:before{content:"\e103"}.glyphicon-fire:before{content:"\e104"}.glyphicon-eye-open:before{content:"\e105"}.glyphicon-eye-close:before{content:"\e106"}.glyphicon-warning-sign:before{content:"\e107"}.glyphicon-plane:before{content:"\e108"}.glyphicon-calendar:before{content:"\e109"}.glyphicon-random:before{content:"\e110"}.glyphicon-comment:before{content:"\e111"}.glyphicon-magnet:before{content:"\e112"}.glyphicon-chevron-up:before{content:"\e113"}.glyphicon-chevron-down:before{content:"\e114"}.glyphicon-retweet:before{content:"\e115"}.glyphicon-shopping-cart:before{content:"\e116"}.glyphicon-folder-close:before{content:"\e117"}.glyphicon-folder-open:before{content:"\e118"}.glyphicon-resize-vertical:before{content:"\e119"}.glyphicon-resize-horizontal:before{content:"\e120"}.glyphicon-hdd:before{content:"\e121"}.glyphicon-bullhorn:before{content:"\e122"}.glyphicon-bell:before{content:"\e123"}.glyphicon-certificate:before{content:"\e124"}.glyphicon-thumbs-up:before{content:"\e125"}.glyphicon-thumbs-down:before{content:"\e126"}.glyphicon-hand-right:before{content:"\e127"}.glyphicon-hand-left:before{content:"\e128"}.glyphicon-hand-up:before{content:"\e129"}.glyphicon-hand-down:before{content:"\e130"}.glyphicon-circle-arrow-right:before{content:"\e131"}.glyphicon-circle-arrow-left:before{content:"\e132"}.glyphicon-circle-arrow-up:before{content:"\e133"}.glyphicon-circle-arrow-down:before{content:"\e134"}.glyphicon-globe:before{content:"\e135"}.glyphicon-wrench:before{content:"\e136"}.glyphicon-tasks:before{content:"\e137"}.glyphicon-filter:before{content:"\e138"}.glyphicon-briefcase:before{content:"\e139"}.glyphicon-fullscreen:before{content:"\e140"}.glyphicon-dashboard:before{content:"\e141"}.glyphicon-paperclip:before{content:"\e142"}.glyphicon-heart-empty:before{content:"\e143"}.glyphicon-link:before{content:"\e144"}.glyphicon-phone:before{content:"\e145"}.glyphicon-pushpin:before{content:"\e146"}.glyphicon-usd:before{content:"\e148"}.glyphicon-gbp:before{content:"\e149"}.glyphicon-sort:before{content:"\e150"}.glyphicon-sort-by-alphabet:before{content:"\e151"}.glyphicon-sort-by-alphabet-alt:before{content:"\e152"}.glyphicon-sort-by-order:before{content:"\e153"}.glyphicon-sort-by-order-alt:before{content:"\e154"}.glyphicon-sort-by-attributes:before{content:"\e155"}.glyphicon-sort-by-attributes-alt:before{content:"\e156"}.glyphicon-unchecked:before{content:"\e157"}.glyphicon-expand:before{content:"\e158"}.glyphicon-collapse-down:before{content:"\e159"}.glyphicon-collapse-up:before{content:"\e160"}.glyphicon-log-in:before{content:"\e161"}.glyphicon-flash:before{content:"\e162"}.glyphicon-log-out:before{content:"\e163"}.glyphicon-new-window:before{content:"\e164"}.glyphicon-record:before{content:"\e165"}.glyphicon-save:before{content:"\e166"}.glyphicon-open:before{content:"\e167"}.glyphicon-saved:before{content:"\e168"}.glyphicon-import:before{content:"\e169"}.glyphicon-export:before{content:"\e170"}.glyphicon-send:before{content:"\e171"}.glyphicon-floppy-disk:before{content:"\e172"}.glyphicon-floppy-saved:before{content:"\e173"}.glyphicon-floppy-remove:before{content:"\e174"}.glyphicon-floppy-save:before{content:"\e175"}.glyphicon-floppy-open:before{content:"\e176"}.glyphicon-credit-card:before{content:"\e177"}.glyphicon-transfer:before{content:"\e178"}.glyphicon-cutlery:before{content:"\e179"}.glyphicon-header:before{content:"\e180"}.glyphicon-compressed:before{content:"\e181"}.glyphicon-earphone:before{content:"\e182"}.glyphicon-phone-alt:before{content:"\e183"}.glyphicon-tower:before{content:"\e184"}.glyphicon-stats:before{content:"\e185"}.glyphicon-sd-video:before{content:"\e186"}.glyphicon-hd-video:before{content:"\e187"}.glyphicon-subtitles:before{content:"\e188"}.glyphicon-sound-stereo:before{content:"\e189"}.glyphicon-sound-dolby:before{content:"\e190"}.glyphicon-sound-5-1:before{content:"\e191"}.glyphicon-sound-6-1:before{content:"\e192"}.glyphicon-sound-7-1:before{content:"\e193"}.glyphicon-copyright-mark:before{content:"\e194"}.glyphicon-registration-mark:before{content:"\e195"}.glyphicon-cloud-download:before{content:"\e197"}.glyphicon-cloud-upload:before{content:"\e198"}.glyphicon-tree-conifer:before{content:"\e199"}.glyphicon-tree-deciduous:before{content:"\e200"}.glyphicon-cd:before{content:"\e201"}.glyphicon-save-file:before{content:"\e202"}.glyphicon-open-file:before{content:"\e203"}.glyphicon-level-up:before{content:"\e204"}.glyphicon-copy:before{content:"\e205"}.glyphicon-paste:before{content:"\e206"}.glyphicon-alert:before{content:"\e209"}.glyphicon-equalizer:before{content:"\e210"}.glyphicon-king:before{content:"\e211"}.glyphicon-queen:before{content:"\e212"}.glyphicon-pawn:before{content:"\e213"}.glyphicon-bishop:before{content:"\e214"}.glyphicon-knight:before{content:"\e215"}.glyphicon-baby-formula:before{content:"\e216"}.glyphicon-tent:before{content:"\26fa"}.glyphicon-blackboard:before{content:"\e218"}.glyphicon-bed:before{content:"\e219"}.glyphicon-apple:before{content:"\f8ff"}.glyphicon-erase:before{content:"\e221"}.glyphicon-hourglass:before{content:"\231b"}.glyphicon-lamp:before{content:"\e223"}.glyphicon-duplicate:before{content:"\e224"}.glyphicon-piggy-bank:before{content:"\e225"}.glyphicon-scissors:before{content:"\e226"}.glyphicon-bitcoin:before{content:"\e227"}.glyphicon-btc:before{content:"\e227"}.glyphicon-xbt:before{content:"\e227"}.glyphicon-yen:before{content:"\00a5"}.glyphicon-jpy:before{content:"\00a5"}.glyphicon-ruble:before{content:"\20bd"}.glyphicon-rub:before{content:"\20bd"}.glyphicon-scale:before{content:"\e230"}.glyphicon-ice-lolly:before{content:"\e231"}.glyphicon-ice-lolly-tasted:before{content:"\e232"}.glyphicon-education:before{content:"\e233"}.glyphicon-option-horizontal:before{content:"\e234"}.glyphicon-option-vertical:before{content:"\e235"}.glyphicon-menu-hamburger:before{content:"\e236"}.glyphicon-modal-window:before{content:"\e237"}.glyphicon-oil:before{content:"\e238"}.glyphicon-grain:before{content:"\e239"}.glyphicon-sunglasses:before{content:"\e240"}.glyphicon-text-size:before{content:"\e241"}.glyphicon-text-color:before{content:"\e242"}.glyphicon-text-background:before{content:"\e243"}.glyphicon-object-align-top:before{content:"\e244"}.glyphicon-object-align-bottom:before{content:"\e245"}.glyphicon-object-align-horizontal:before{content:"\e246"}.glyphicon-object-align-left:before{content:"\e247"}.glyphicon-object-align-vertical:before{content:"\e248"}.glyphicon-object-align-right:before{content:"\e249"}.glyphicon-triangle-right:before{content:"\e250"}.glyphicon-triangle-left:before{content:"\e251"}.glyphicon-triangle-bottom:before{content:"\e252"}.glyphicon-triangle-top:before{content:"\e253"}.glyphicon-console:before{content:"\e254"}.glyphicon-superscript:before{content:"\e255"}.glyphicon-subscript:before{content:"\e256"}.glyphicon-menu-left:before{content:"\e257"}.glyphicon-menu-right:before{content:"\e258"}.glyphicon-menu-down:before{content:"\e259"}.glyphicon-menu-up:before{content:"\e260"}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:10px;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}button,input,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#337ab7;text-decoration:none}a:focus,a:hover{color:#23527c;text-decoration:underline}a:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}figure{margin:0}img{vertical-align:middle}.carousel-inner>.item>a>img,.carousel-inner>.item>img,.img-responsive,.thumbnail a>img,.thumbnail>img{display:block;max-width:100%;height:auto}.img-rounded{border-radius:6px}.img-thumbnail{display:inline-block;max-width:100%;height:auto;padding:4px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.img-circle{border-radius:50%}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}[role=button]{cursor:pointer}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}.h1 .small,.h1 small,.h2 .small,.h2 small,.h3 .small,.h3 small,.h4 .small,.h4 small,.h5 .small,.h5 small,.h6 .small,.h6 small,h1 .small,h1 small,h2 .small,h2 small,h3 .small,h3 small,h4 .small,h4 small,h5 .small,h5 small,h6 .small,h6 small{font-weight:400;line-height:1;color:#777}.h1,.h2,.h3,h1,h2,h3{margin-top:20px;margin-bottom:10px}.h1 .small,.h1 small,.h2 .small,.h2 small,.h3 .small,.h3 small,h1 .small,h1 small,h2 .small,h2 small,h3 .small,h3 small{font-size:65%}.h4,.h5,.h6,h4,h5,h6{margin-top:10px;margin-bottom:10px}.h4 .small,.h4 small,.h5 .small,.h5 small,.h6 .small,.h6 small,h4 .small,h4 small,h5 .small,h5 small,h6 .small,h6 small{font-size:75%}.h1,h1{font-size:36px}.h2,h2{font-size:30px}.h3,h3{font-size:24px}.h4,h4{font-size:18px}.h5,h5{font-size:14px}.h6,h6{font-size:12px}p{margin:0 0 10px}.lead{margin-bottom:20px;font-size:16px;font-weight:300;line-height:1.4}@media (min-width:768px){.lead{font-size:21px}}.small,small{font-size:85%}.mark,mark{padding:.2em;background-color:#fcf8e3}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.text-nowrap{white-space:nowrap}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.text-muted{color:#777}.text-primary{color:#337ab7}a.text-primary:hover{color:#286090}.text-success{color:#3c763d}a.text-success:hover{color:#2b542c}.text-info{color:#31708f}a.text-info:hover{color:#245269}.text-warning{color:#8a6d3b}a.text-warning:hover{color:#66512c}.text-danger{color:#a94442}a.text-danger:hover{color:#843534}.bg-primary{color:#fff;background-color:#337ab7}a.bg-primary:hover{background-color:#286090}.bg-success{background-color:#dff0d8}a.bg-success:hover{background-color:#c1e2b3}.bg-info{background-color:#d9edf7}a.bg-info:hover{background-color:#afd9ee}.bg-warning{background-color:#fcf8e3}a.bg-warning:hover{background-color:#f7ecb5}.bg-danger{background-color:#f2dede}a.bg-danger:hover{background-color:#e4b9b9}.page-header{padding-bottom:9px;margin:40px 0 20px;border-bottom:1px solid #eee}ol,ul{margin-top:0;margin-bottom:10px}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;margin-left:-5px;list-style:none}.list-inline>li{display:inline-block;padding-right:5px;padding-left:5px}dl{margin-top:0;margin-bottom:20px}dd,dt{line-height:1.42857143}dt{font-weight:700}dd{margin-left:0}@media (min-width:768px){.dl-horizontal dt{float:left;width:160px;overflow:hidden;clear:left;text-align:right;text-overflow:ellipsis;white-space:nowrap}.dl-horizontal dd{margin-left:180px}}abbr[data-original-title],abbr[title]{cursor:help;border-bottom:1px dotted #777}.initialism{font-size:90%;text-transform:uppercase}blockquote{padding:10px 20px;margin:0 0 20px;font-size:17.5px;border-left:5px solid #eee}blockquote ol:last-child,blockquote p:last-child,blockquote ul:last-child{margin-bottom:0}blockquote .small,blockquote footer,blockquote small{display:block;font-size:80%;line-height:1.42857143;color:#777}blockquote .small:before,blockquote footer:before,blockquote small:before{content:'\2014 \00A0'}.blockquote-reverse,blockquote.pull-right{padding-right:15px;padding-left:0;text-align:right;border-right:5px solid #eee;border-left:0}.blockquote-reverse .small:before,.blockquote-reverse footer:before,.blockquote-reverse small:before,blockquote.pull-right .small:before,blockquote.pull-right footer:before,blockquote.pull-right small:before{content:''}.blockquote-reverse .small:after,.blockquote-reverse footer:after,.blockquote-reverse small:after,blockquote.pull-right .small:after,blockquote.pull-right footer:after,blockquote.pull-right small:after{content:'\00A0 \2014'}address{margin-bottom:20px;font-style:normal;line-height:1.42857143}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,"Courier New",monospace}code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:4px}kbd{padding:2px 4px;font-size:90%;color:#fff;background-color:#333;border-radius:3px;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.25);box-shadow:inset 0 -1px 0 rgba(0,0,0,.25)}kbd kbd{padding:0;font-size:100%;font-weight:700;-webkit-box-shadow:none;box-shadow:none}pre{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0}.pre-scrollable{max-height:340px;overflow-y:scroll}.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:768px){.container{width:750px}}@media (min-width:992px){.container{width:970px}}@media (min-width:1200px){.container{width:1170px}}.container-fluid{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.row{margin-right:-15px;margin-left:-15px}.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9{position:relative;min-height:1px;padding-right:15px;padding-left:15px}.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9{float:left}.col-xs-12{width:100%}.col-xs-11{width:91.66666667%}.col-xs-10{width:83.33333333%}.col-xs-9{width:75%}.col-xs-8{width:66.66666667%}.col-xs-7{width:58.33333333%}.col-xs-6{width:50%}.col-xs-5{width:41.66666667%}.col-xs-4{width:33.33333333%}.col-xs-3{width:25%}.col-xs-2{width:16.66666667%}.col-xs-1{width:8.33333333%}.col-xs-pull-12{right:100%}.col-xs-pull-11{right:91.66666667%}.col-xs-pull-10{right:83.33333333%}.col-xs-pull-9{right:75%}.col-xs-pull-8{right:66.66666667%}.col-xs-pull-7{right:58.33333333%}.col-xs-pull-6{right:50%}.col-xs-pull-5{right:41.66666667%}.col-xs-pull-4{right:33.33333333%}.col-xs-pull-3{right:25%}.col-xs-pull-2{right:16.66666667%}.col-xs-pull-1{right:8.33333333%}.col-xs-pull-0{right:auto}.col-xs-push-12{left:100%}.col-xs-push-11{left:91.66666667%}.col-xs-push-10{left:83.33333333%}.col-xs-push-9{left:75%}.col-xs-push-8{left:66.66666667%}.col-xs-push-7{left:58.33333333%}.col-xs-push-6{left:50%}.col-xs-push-5{left:41.66666667%}.col-xs-push-4{left:33.33333333%}.col-xs-push-3{left:25%}.col-xs-push-2{left:16.66666667%}.col-xs-push-1{left:8.33333333%}.col-xs-push-0{left:auto}.col-xs-offset-12{margin-left:100%}.col-xs-offset-11{margin-left:91.66666667%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-0{margin-left:0}@media (min-width:768px){.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width:992px){.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}@media (min-width:1200px){.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9{float:left}.col-lg-12{width:100%}.col-lg-11{width:91.66666667%}.col-lg-10{width:83.33333333%}.col-lg-9{width:75%}.col-lg-8{width:66.66666667%}.col-lg-7{width:58.33333333%}.col-lg-6{width:50%}.col-lg-5{width:41.66666667%}.col-lg-4{width:33.33333333%}.col-lg-3{width:25%}.col-lg-2{width:16.66666667%}.col-lg-1{width:8.33333333%}.col-lg-pull-12{right:100%}.col-lg-pull-11{right:91.66666667%}.col-lg-pull-10{right:83.33333333%}.col-lg-pull-9{right:75%}.col-lg-pull-8{right:66.66666667%}.col-lg-pull-7{right:58.33333333%}.col-lg-pull-6{right:50%}.col-lg-pull-5{right:41.66666667%}.col-lg-pull-4{right:33.33333333%}.col-lg-pull-3{right:25%}.col-lg-pull-2{right:16.66666667%}.col-lg-pull-1{right:8.33333333%}.col-lg-pull-0{right:auto}.col-lg-push-12{left:100%}.col-lg-push-11{left:91.66666667%}.col-lg-push-10{left:83.33333333%}.col-lg-push-9{left:75%}.col-lg-push-8{left:66.66666667%}.col-lg-push-7{left:58.33333333%}.col-lg-push-6{left:50%}.col-lg-push-5{left:41.66666667%}.col-lg-push-4{left:33.33333333%}.col-lg-push-3{left:25%}.col-lg-push-2{left:16.66666667%}.col-lg-push-1{left:8.33333333%}.col-lg-push-0{left:auto}.col-lg-offset-12{margin-left:100%}.col-lg-offset-11{margin-left:91.66666667%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-0{margin-left:0}}table{background-color:transparent}caption{padding-top:8px;padding-bottom:8px;color:#777;text-align:left}th{text-align:left}.table{width:100%;max-width:100%;margin-bottom:20px}.table>tbody>tr>td,.table>tbody>tr>th,.table>tfoot>tr>td,.table>tfoot>tr>th,.table>thead>tr>td,.table>thead>tr>th{padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>td,.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>td,.table>thead:first-child>tr:first-child>th{border-top:0}.table>tbody+tbody{border-top:2px solid #ddd}.table .table{background-color:#fff}.table-condensed>tbody>tr>td,.table-condensed>tbody>tr>th,.table-condensed>tfoot>tr>td,.table-condensed>tfoot>tr>th,.table-condensed>thead>tr>td,.table-condensed>thead>tr>th{padding:5px}.table-bordered{border:1px solid #ddd}.table-bordered>tbody>tr>td,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>td,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border:1px solid #ddd}.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border-bottom-width:2px}.table-striped>tbody>tr:nth-of-type(odd){background-color:#f9f9f9}.table-hover>tbody>tr:hover{background-color:#f5f5f5}table col[class*=col-]{position:static;display:table-column;float:none}table td[class*=col-],table th[class*=col-]{position:static;display:table-cell;float:none}.table>tbody>tr.active>td,.table>tbody>tr.active>th,.table>tbody>tr>td.active,.table>tbody>tr>th.active,.table>tfoot>tr.active>td,.table>tfoot>tr.active>th,.table>tfoot>tr>td.active,.table>tfoot>tr>th.active,.table>thead>tr.active>td,.table>thead>tr.active>th,.table>thead>tr>td.active,.table>thead>tr>th.active{background-color:#f5f5f5}.table-hover>tbody>tr.active:hover>td,.table-hover>tbody>tr.active:hover>th,.table-hover>tbody>tr:hover>.active,.table-hover>tbody>tr>td.active:hover,.table-hover>tbody>tr>th.active:hover{background-color:#e8e8e8}.table>tbody>tr.success>td,.table>tbody>tr.success>th,.table>tbody>tr>td.success,.table>tbody>tr>th.success,.table>tfoot>tr.success>td,.table>tfoot>tr.success>th,.table>tfoot>tr>td.success,.table>tfoot>tr>th.success,.table>thead>tr.success>td,.table>thead>tr.success>th,.table>thead>tr>td.success,.table>thead>tr>th.success{background-color:#dff0d8}.table-hover>tbody>tr.success:hover>td,.table-hover>tbody>tr.success:hover>th,.table-hover>tbody>tr:hover>.success,.table-hover>tbody>tr>td.success:hover,.table-hover>tbody>tr>th.success:hover{background-color:#d0e9c6}.table>tbody>tr.info>td,.table>tbody>tr.info>th,.table>tbody>tr>td.info,.table>tbody>tr>th.info,.table>tfoot>tr.info>td,.table>tfoot>tr.info>th,.table>tfoot>tr>td.info,.table>tfoot>tr>th.info,.table>thead>tr.info>td,.table>thead>tr.info>th,.table>thead>tr>td.info,.table>thead>tr>th.info{background-color:#d9edf7}.table-hover>tbody>tr.info:hover>td,.table-hover>tbody>tr.info:hover>th,.table-hover>tbody>tr:hover>.info,.table-hover>tbody>tr>td.info:hover,.table-hover>tbody>tr>th.info:hover{background-color:#c4e3f3}.table>tbody>tr.warning>td,.table>tbody>tr.warning>th,.table>tbody>tr>td.warning,.table>tbody>tr>th.warning,.table>tfoot>tr.warning>td,.table>tfoot>tr.warning>th,.table>tfoot>tr>td.warning,.table>tfoot>tr>th.warning,.table>thead>tr.warning>td,.table>thead>tr.warning>th,.table>thead>tr>td.warning,.table>thead>tr>th.warning{background-color:#fcf8e3}.table-hover>tbody>tr.warning:hover>td,.table-hover>tbody>tr.warning:hover>th,.table-hover>tbody>tr:hover>.warning,.table-hover>tbody>tr>td.warning:hover,.table-hover>tbody>tr>th.warning:hover{background-color:#faf2cc}.table>tbody>tr.danger>td,.table>tbody>tr.danger>th,.table>tbody>tr>td.danger,.table>tbody>tr>th.danger,.table>tfoot>tr.danger>td,.table>tfoot>tr.danger>th,.table>tfoot>tr>td.danger,.table>tfoot>tr>th.danger,.table>thead>tr.danger>td,.table>thead>tr.danger>th,.table>thead>tr>td.danger,.table>thead>tr>th.danger{background-color:#f2dede}.table-hover>tbody>tr.danger:hover>td,.table-hover>tbody>tr.danger:hover>th,.table-hover>tbody>tr:hover>.danger,.table-hover>tbody>tr>td.danger:hover,.table-hover>tbody>tr>th.danger:hover{background-color:#ebcccc}.table-responsive{min-height:.01%;overflow-x:auto}@media screen and (max-width:767px){.table-responsive{width:100%;margin-bottom:15px;overflow-y:hidden;-ms-overflow-style:-ms-autohiding-scrollbar;border:1px solid #ddd}.table-responsive>.table{margin-bottom:0}.table-responsive>.table>tbody>tr>td,.table-responsive>.table>tbody>tr>th,.table-responsive>.table>tfoot>tr>td,.table-responsive>.table>tfoot>tr>th,.table-responsive>.table>thead>tr>td,.table-responsive>.table>thead>tr>th{white-space:nowrap}.table-responsive>.table-bordered{border:0}.table-responsive>.table-bordered>tbody>tr>td:first-child,.table-responsive>.table-bordered>tbody>tr>th:first-child,.table-responsive>.table-bordered>tfoot>tr>td:first-child,.table-responsive>.table-bordered>tfoot>tr>th:first-child,.table-responsive>.table-bordered>thead>tr>td:first-child,.table-responsive>.table-bordered>thead>tr>th:first-child{border-left:0}.table-responsive>.table-bordered>tbody>tr>td:last-child,.table-responsive>.table-bordered>tbody>tr>th:last-child,.table-responsive>.table-bordered>tfoot>tr>td:last-child,.table-responsive>.table-bordered>tfoot>tr>th:last-child,.table-responsive>.table-bordered>thead>tr>td:last-child,.table-responsive>.table-bordered>thead>tr>th:last-child{border-right:0}.table-responsive>.table-bordered>tbody>tr:last-child>td,.table-responsive>.table-bordered>tbody>tr:last-child>th,.table-responsive>.table-bordered>tfoot>tr:last-child>td,.table-responsive>.table-bordered>tfoot>tr:last-child>th{border-bottom:0}}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;padding:0;margin-bottom:20px;font-size:21px;line-height:inherit;color:#333;border:0;border-bottom:1px solid #e5e5e5}label{display:inline-block;max-width:100%;margin-bottom:5px;font-weight:700}input[type=search]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}input[type=checkbox],input[type=radio]{margin:4px 0 0;margin-top:1px \9;line-height:normal}input[type=file]{display:block}input[type=range]{display:block;width:100%}select[multiple],select[size]{height:auto}input[type=file]:focus,input[type=checkbox]:focus,input[type=radio]:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}output{display:block;padding-top:7px;font-size:14px;line-height:1.42857143;color:#555}.form-control{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.form-control::-moz-placeholder{color:#999;opacity:1}.form-control:-ms-input-placeholder{color:#999}.form-control::-webkit-input-placeholder{color:#999}.form-control[disabled],.form-control[readonly],fieldset[disabled] .form-control{background-color:#eee;opacity:1}.form-control[disabled],fieldset[disabled] .form-control{cursor:not-allowed}textarea.form-control{height:auto}input[type=search]{-webkit-appearance:none}@media screen and (-webkit-min-device-pixel-ratio:0){input[type=date],input[type=time],input[type=datetime-local],input[type=month]{line-height:34px}.input-group-sm input[type=date],.input-group-sm input[type=time],.input-group-sm input[type=datetime-local],.input-group-sm input[type=month],input[type=date].input-sm,input[type=time].input-sm,input[type=datetime-local].input-sm,input[type=month].input-sm{line-height:30px}.input-group-lg input[type=date],.input-group-lg input[type=time],.input-group-lg input[type=datetime-local],.input-group-lg input[type=month],input[type=date].input-lg,input[type=time].input-lg,input[type=datetime-local].input-lg,input[type=month].input-lg{line-height:46px}}.form-group{margin-bottom:15px}.checkbox,.radio{position:relative;display:block;margin-top:10px;margin-bottom:10px}.checkbox label,.radio label{min-height:20px;padding-left:20px;margin-bottom:0;font-weight:400;cursor:pointer}.checkbox input[type=checkbox],.checkbox-inline input[type=checkbox],.radio input[type=radio],.radio-inline input[type=radio]{position:absolute;margin-top:4px \9;margin-left:-20px}.checkbox+.checkbox,.radio+.radio{margin-top:-5px}.checkbox-inline,.radio-inline{position:relative;display:inline-block;padding-left:20px;margin-bottom:0;font-weight:400;vertical-align:middle;cursor:pointer}.checkbox-inline+.checkbox-inline,.radio-inline+.radio-inline{margin-top:0;margin-left:10px}fieldset[disabled] input[type=checkbox],fieldset[disabled] input[type=radio],input[type=checkbox].disabled,input[type=checkbox][disabled],input[type=radio].disabled,input[type=radio][disabled]{cursor:not-allowed}.checkbox-inline.disabled,.radio-inline.disabled,fieldset[disabled] .checkbox-inline,fieldset[disabled] .radio-inline{cursor:not-allowed}.checkbox.disabled label,.radio.disabled label,fieldset[disabled] .checkbox label,fieldset[disabled] .radio label{cursor:not-allowed}.form-control-static{min-height:34px;padding-top:7px;padding-bottom:7px;margin-bottom:0}.form-control-static.input-lg,.form-control-static.input-sm{padding-right:0;padding-left:0}.input-sm{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-sm{height:30px;line-height:30px}select[multiple].input-sm,textarea.input-sm{height:auto}.form-group-sm .form-control{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.form-group-sm .form-control{height:30px;line-height:30px}select[multiple].form-group-sm .form-control,textarea.form-group-sm .form-control{height:auto}.form-group-sm .form-control-static{height:30px;min-height:32px;padding:5px 10px;font-size:12px;line-height:1.5}.input-lg{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.input-lg{height:46px;line-height:46px}select[multiple].input-lg,textarea.input-lg{height:auto}.form-group-lg .form-control{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.form-group-lg .form-control{height:46px;line-height:46px}select[multiple].form-group-lg .form-control,textarea.form-group-lg .form-control{height:auto}.form-group-lg .form-control-static{height:46px;min-height:38px;padding:10px 16px;font-size:18px;line-height:1.3333333}.has-feedback{position:relative}.has-feedback .form-control{padding-right:42.5px}.form-control-feedback{position:absolute;top:0;right:0;z-index:2;display:block;width:34px;height:34px;line-height:34px;text-align:center;pointer-events:none}.input-lg+.form-control-feedback{width:46px;height:46px;line-height:46px}.input-sm+.form-control-feedback{width:30px;height:30px;line-height:30px}.has-success .checkbox,.has-success .checkbox-inline,.has-success .control-label,.has-success .help-block,.has-success .radio,.has-success .radio-inline,.has-success.checkbox label,.has-success.checkbox-inline label,.has-success.radio label,.has-success.radio-inline label{color:#3c763d}.has-success .form-control{border-color:#3c763d;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-success .form-control:focus{border-color:#2b542c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #67b168;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #67b168}.has-success .input-group-addon{color:#3c763d;background-color:#dff0d8;border-color:#3c763d}.has-success .form-control-feedback{color:#3c763d}.has-warning .checkbox,.has-warning .checkbox-inline,.has-warning .control-label,.has-warning .help-block,.has-warning .radio,.has-warning .radio-inline,.has-warning.checkbox label,.has-warning.checkbox-inline label,.has-warning.radio label,.has-warning.radio-inline label{color:#8a6d3b}.has-warning .form-control{border-color:#8a6d3b;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-warning .form-control:focus{border-color:#66512c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #c0a16b;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #c0a16b}.has-warning .input-group-addon{color:#8a6d3b;background-color:#fcf8e3;border-color:#8a6d3b}.has-warning .form-control-feedback{color:#8a6d3b}.has-error .checkbox,.has-error .checkbox-inline,.has-error .control-label,.has-error .help-block,.has-error .radio,.has-error .radio-inline,.has-error.checkbox label,.has-error.checkbox-inline label,.has-error.radio label,.has-error.radio-inline label{color:#a94442}.has-error .form-control{border-color:#a94442;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-error .form-control:focus{border-color:#843534;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #ce8483;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #ce8483}.has-error .input-group-addon{color:#a94442;background-color:#f2dede;border-color:#a94442}.has-error .form-control-feedback{color:#a94442}.has-feedback label~.form-control-feedback{top:25px}.has-feedback label.sr-only~.form-control-feedback{top:0}.help-block{display:block;margin-top:5px;margin-bottom:10px;color:#737373}@media (min-width:768px){.form-inline .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .form-control-static{display:inline-block}.form-inline .input-group{display:inline-table;vertical-align:middle}.form-inline .input-group .form-control,.form-inline .input-group .input-group-addon,.form-inline .input-group .input-group-btn{width:auto}.form-inline .input-group>.form-control{width:100%}.form-inline .control-label{margin-bottom:0;vertical-align:middle}.form-inline .checkbox,.form-inline .radio{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.form-inline .checkbox label,.form-inline .radio label{padding-left:0}.form-inline .checkbox input[type=checkbox],.form-inline .radio input[type=radio]{position:relative;margin-left:0}.form-inline .has-feedback .form-control-feedback{top:0}}.form-horizontal .checkbox,.form-horizontal .checkbox-inline,.form-horizontal .radio,.form-horizontal .radio-inline{padding-top:7px;margin-top:0;margin-bottom:0}.form-horizontal .checkbox,.form-horizontal .radio{min-height:27px}.form-horizontal .form-group{margin-right:-15px;margin-left:-15px}@media (min-width:768px){.form-horizontal .control-label{padding-top:7px;margin-bottom:0;text-align:right}}.form-horizontal .has-feedback .form-control-feedback{right:15px}@media (min-width:768px){.form-horizontal .form-group-lg .control-label{padding-top:14.33px}}@media (min-width:768px){.form-horizontal .form-group-sm .control-label{padding-top:6px}}.btn{display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.42857143;text-align:center;white-space:nowrap;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-image:none;border:1px solid transparent;border-radius:4px}.btn.active.focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn:active:focus,.btn:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn.focus,.btn:focus,.btn:hover{color:#333;text-decoration:none}.btn.active,.btn:active{background-image:none;outline:0;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{pointer-events:none;cursor:not-allowed;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none;opacity:.65}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default.active,.btn-default.focus,.btn-default:active,.btn-default:focus,.btn-default:hover,.open>.dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default.active,.btn-default:active,.open>.dropdown-toggle.btn-default{background-image:none}.btn-default.disabled,.btn-default.disabled.active,.btn-default.disabled.focus,.btn-default.disabled:active,.btn-default.disabled:focus,.btn-default.disabled:hover,.btn-default[disabled],.btn-default[disabled].active,.btn-default[disabled].focus,.btn-default[disabled]:active,.btn-default[disabled]:focus,.btn-default[disabled]:hover,fieldset[disabled] .btn-default,fieldset[disabled] .btn-default.active,fieldset[disabled] .btn-default.focus,fieldset[disabled] .btn-default:active,fieldset[disabled] .btn-default:focus,fieldset[disabled] .btn-default:hover{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#337ab7;border-color:#2e6da4}.btn-primary.active,.btn-primary.focus,.btn-primary:active,.btn-primary:focus,.btn-primary:hover,.open>.dropdown-toggle.btn-primary{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary.active,.btn-primary:active,.open>.dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled,.btn-primary.disabled.active,.btn-primary.disabled.focus,.btn-primary.disabled:active,.btn-primary.disabled:focus,.btn-primary.disabled:hover,.btn-primary[disabled],.btn-primary[disabled].active,.btn-primary[disabled].focus,.btn-primary[disabled]:active,.btn-primary[disabled]:focus,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary,fieldset[disabled] .btn-primary.active,fieldset[disabled] .btn-primary.focus,fieldset[disabled] .btn-primary:active,fieldset[disabled] .btn-primary:focus,fieldset[disabled] .btn-primary:hover{background-color:#337ab7;border-color:#2e6da4}.btn-primary .badge{color:#337ab7;background-color:#fff}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success.active,.btn-success.focus,.btn-success:active,.btn-success:focus,.btn-success:hover,.open>.dropdown-toggle.btn-success{color:#fff;background-color:#449d44;border-color:#398439}.btn-success.active,.btn-success:active,.open>.dropdown-toggle.btn-success{background-image:none}.btn-success.disabled,.btn-success.disabled.active,.btn-success.disabled.focus,.btn-success.disabled:active,.btn-success.disabled:focus,.btn-success.disabled:hover,.btn-success[disabled],.btn-success[disabled].active,.btn-success[disabled].focus,.btn-success[disabled]:active,.btn-success[disabled]:focus,.btn-success[disabled]:hover,fieldset[disabled] .btn-success,fieldset[disabled] .btn-success.active,fieldset[disabled] .btn-success.focus,fieldset[disabled] .btn-success:active,fieldset[disabled] .btn-success:focus,fieldset[disabled] .btn-success:hover{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info.active,.btn-info.focus,.btn-info:active,.btn-info:focus,.btn-info:hover,.open>.dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info.active,.btn-info:active,.open>.dropdown-toggle.btn-info{background-image:none}.btn-info.disabled,.btn-info.disabled.active,.btn-info.disabled.focus,.btn-info.disabled:active,.btn-info.disabled:focus,.btn-info.disabled:hover,.btn-info[disabled],.btn-info[disabled].active,.btn-info[disabled].focus,.btn-info[disabled]:active,.btn-info[disabled]:focus,.btn-info[disabled]:hover,fieldset[disabled] .btn-info,fieldset[disabled] .btn-info.active,fieldset[disabled] .btn-info.focus,fieldset[disabled] .btn-info:active,fieldset[disabled] .btn-info:focus,fieldset[disabled] .btn-info:hover{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning.active,.btn-warning.focus,.btn-warning:active,.btn-warning:focus,.btn-warning:hover,.open>.dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning.active,.btn-warning:active,.open>.dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled,.btn-warning.disabled.active,.btn-warning.disabled.focus,.btn-warning.disabled:active,.btn-warning.disabled:focus,.btn-warning.disabled:hover,.btn-warning[disabled],.btn-warning[disabled].active,.btn-warning[disabled].focus,.btn-warning[disabled]:active,.btn-warning[disabled]:focus,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning,fieldset[disabled] .btn-warning.active,fieldset[disabled] .btn-warning.focus,fieldset[disabled] .btn-warning:active,fieldset[disabled] .btn-warning:focus,fieldset[disabled] .btn-warning:hover{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger.active,.btn-danger.focus,.btn-danger:active,.btn-danger:focus,.btn-danger:hover,.open>.dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger.active,.btn-danger:active,.open>.dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled,.btn-danger.disabled.active,.btn-danger.disabled.focus,.btn-danger.disabled:active,.btn-danger.disabled:focus,.btn-danger.disabled:hover,.btn-danger[disabled],.btn-danger[disabled].active,.btn-danger[disabled].focus,.btn-danger[disabled]:active,.btn-danger[disabled]:focus,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger,fieldset[disabled] .btn-danger.active,fieldset[disabled] .btn-danger.focus,fieldset[disabled] .btn-danger:active,fieldset[disabled] .btn-danger:focus,fieldset[disabled] .btn-danger:hover{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{font-weight:400;color:#337ab7;border-radius:0}.btn-link,.btn-link.active,.btn-link:active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:active,.btn-link:focus,.btn-link:hover{border-color:transparent}.btn-link:focus,.btn-link:hover{color:#23527c;text-decoration:underline;background-color:transparent}.btn-link[disabled]:focus,.btn-link[disabled]:hover,fieldset[disabled] .btn-link:focus,fieldset[disabled] .btn-link:hover{color:#777;text-decoration:none}.btn-group-lg>.btn,.btn-lg{padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}.btn-group-sm>.btn,.btn-sm{padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.btn-group-xs>.btn,.btn-xs{padding:1px 5px;font-size:12px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:5px}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}.fade{opacity:0;-webkit-transition:opacity .15s linear;-o-transition:opacity .15s linear;transition:opacity .15s linear}.fade.in{opacity:1}.collapse{display:none}.collapse.in{display:block}tr.collapse.in{display:table-row}tbody.collapse.in{display:table-row-group}.collapsing{position:relative;height:0;overflow:hidden;-webkit-transition-timing-function:ease;-o-transition-timing-function:ease;transition-timing-function:ease;-webkit-transition-duration:.35s;-o-transition-duration:.35s;transition-duration:.35s;-webkit-transition-property:height,visibility;-o-transition-property:height,visibility;transition-property:height,visibility}.caret{display:inline-block;width:0;height:0;margin-left:2px;vertical-align:middle;border-top:4px dashed;border-right:4px solid transparent;border-left:4px solid transparent}.dropdown,.dropup{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;font-size:14px;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,.175);box-shadow:0 6px 12px rgba(0,0,0,.175)}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu>li>a{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.42857143;color:#333;white-space:nowrap}.dropdown-menu>li>a:focus,.dropdown-menu>li>a:hover{color:#262626;text-decoration:none;background-color:#f5f5f5}.dropdown-menu>.active>a,.dropdown-menu>.active>a:focus,.dropdown-menu>.active>a:hover{color:#fff;text-decoration:none;background-color:#337ab7;outline:0}.dropdown-menu>.disabled>a,.dropdown-menu>.disabled>a:focus,.dropdown-menu>.disabled>a:hover{color:#777}.dropdown-menu>.disabled>a:focus,.dropdown-menu>.disabled>a:hover{text-decoration:none;cursor:not-allowed;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled=false)}.open>.dropdown-menu{display:block}.open>a{outline:0}.dropdown-menu-right{right:0;left:auto}.dropdown-menu-left{right:auto;left:0}.dropdown-header{display:block;padding:3px 20px;font-size:12px;line-height:1.42857143;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:990}.pull-right>.dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{content:"";border-top:0;border-bottom:4px solid}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}@media (min-width:768px){.navbar-right .dropdown-menu{right:0;left:auto}.navbar-right .dropdown-menu-left{right:auto;left:0}}.btn-group,.btn-group-vertical{position:relative;display:inline-block;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;float:left}.btn-group-vertical>.btn.active,.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group-vertical>.btn:hover,.btn-group>.btn.active,.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:2}.btn-group .btn+.btn,.btn-group .btn+.btn-group,.btn-group .btn-group+.btn,.btn-group .btn-group+.btn-group{margin-left:-1px}.btn-toolbar{margin-left:-5px}.btn-toolbar .btn-group,.btn-toolbar .input-group{float:left}.btn-toolbar>.btn,.btn-toolbar>.btn-group,.btn-toolbar>.input-group{margin-left:5px}.btn-group>.btn:not(:first-child):not(:last-child):not(.dropdown-toggle){border-radius:0}.btn-group>.btn:first-child{margin-left:0}.btn-group>.btn:first-child:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn:last-child:not(:first-child),.btn-group>.dropdown-toggle:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.btn-group>.btn-group{float:left}.btn-group>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.btn-group .dropdown-toggle:active,.btn-group.open .dropdown-toggle{outline:0}.btn-group>.btn+.dropdown-toggle{padding-right:8px;padding-left:8px}.btn-group>.btn-lg+.dropdown-toggle{padding-right:12px;padding-left:12px}.btn-group.open .dropdown-toggle{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn-group.open .dropdown-toggle.btn-link{-webkit-box-shadow:none;box-shadow:none}.btn .caret{margin-left:0}.btn-lg .caret{border-width:5px 5px 0;border-bottom-width:0}.dropup .btn-lg .caret{border-width:0 5px 5px}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group,.btn-group-vertical>.btn-group>.btn{display:block;float:none;width:100%;max-width:100%}.btn-group-vertical>.btn-group>.btn{float:none}.btn-group-vertical>.btn+.btn,.btn-group-vertical>.btn+.btn-group,.btn-group-vertical>.btn-group+.btn,.btn-group-vertical>.btn-group+.btn-group{margin-top:-1px;margin-left:0}.btn-group-vertical>.btn:not(:first-child):not(:last-child){border-radius:0}.btn-group-vertical>.btn:first-child:not(:last-child){border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn:last-child:not(:first-child){border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:4px}.btn-group-vertical>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group-vertical>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group-vertical>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-left-radius:0;border-top-right-radius:0}.btn-group-justified{display:table;width:100%;table-layout:fixed;border-collapse:separate}.btn-group-justified>.btn,.btn-group-justified>.btn-group{display:table-cell;float:none;width:1%}.btn-group-justified>.btn-group .btn{width:100%}.btn-group-justified>.btn-group .dropdown-menu{left:auto}[data-toggle=buttons]>.btn input[type=checkbox],[data-toggle=buttons]>.btn input[type=radio],[data-toggle=buttons]>.btn-group>.btn input[type=checkbox],[data-toggle=buttons]>.btn-group>.btn input[type=radio]{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.input-group{position:relative;display:table;border-collapse:separate}.input-group[class*=col-]{float:none;padding-right:0;padding-left:0}.input-group .form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.input-group-lg>.form-control,.input-group-lg>.input-group-addon,.input-group-lg>.input-group-btn>.btn{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.input-group-lg>.form-control,select.input-group-lg>.input-group-addon,select.input-group-lg>.input-group-btn>.btn{height:46px;line-height:46px}select[multiple].input-group-lg>.form-control,select[multiple].input-group-lg>.input-group-addon,select[multiple].input-group-lg>.input-group-btn>.btn,textarea.input-group-lg>.form-control,textarea.input-group-lg>.input-group-addon,textarea.input-group-lg>.input-group-btn>.btn{height:auto}.input-group-sm>.form-control,.input-group-sm>.input-group-addon,.input-group-sm>.input-group-btn>.btn{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-group-sm>.form-control,select.input-group-sm>.input-group-addon,select.input-group-sm>.input-group-btn>.btn{height:30px;line-height:30px}select[multiple].input-group-sm>.form-control,select[multiple].input-group-sm>.input-group-addon,select[multiple].input-group-sm>.input-group-btn>.btn,textarea.input-group-sm>.form-control,textarea.input-group-sm>.input-group-addon,textarea.input-group-sm>.input-group-btn>.btn{height:auto}.input-group .form-control,.input-group-addon,.input-group-btn{display:table-cell}.input-group .form-control:not(:first-child):not(:last-child),.input-group-addon:not(:first-child):not(:last-child),.input-group-btn:not(:first-child):not(:last-child){border-radius:0}.input-group-addon,.input-group-btn{width:1%;white-space:nowrap;vertical-align:middle}.input-group-addon{padding:6px 12px;font-size:14px;font-weight:400;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;border-radius:4px}.input-group-addon.input-sm{padding:5px 10px;font-size:12px;border-radius:3px}.input-group-addon.input-lg{padding:10px 16px;font-size:18px;border-radius:6px}.input-group-addon input[type=checkbox],.input-group-addon input[type=radio]{margin-top:0}.input-group .form-control:first-child,.input-group-addon:first-child,.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group>.btn,.input-group-btn:first-child>.dropdown-toggle,.input-group-btn:last-child>.btn-group:not(:last-child)>.btn,.input-group-btn:last-child>.btn:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.input-group-addon:first-child{border-right:0}.input-group .form-control:last-child,.input-group-addon:last-child,.input-group-btn:first-child>.btn-group:not(:first-child)>.btn,.input-group-btn:first-child>.btn:not(:first-child),.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group>.btn,.input-group-btn:last-child>.dropdown-toggle{border-top-left-radius:0;border-bottom-left-radius:0}.input-group-addon:last-child{border-left:0}.input-group-btn{position:relative;font-size:0;white-space:nowrap}.input-group-btn>.btn{position:relative}.input-group-btn>.btn+.btn{margin-left:-1px}.input-group-btn>.btn:active,.input-group-btn>.btn:focus,.input-group-btn>.btn:hover{z-index:2}.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group{margin-right:-1px}.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group{margin-left:-1px}.nav{padding-left:0;margin-bottom:0;list-style:none}.nav>li{position:relative;display:block}.nav>li>a{position:relative;display:block;padding:10px 15px}.nav>li>a:focus,.nav>li>a:hover{text-decoration:none;background-color:#eee}.nav>li.disabled>a{color:#777}.nav>li.disabled>a:focus,.nav>li.disabled>a:hover{color:#777;text-decoration:none;cursor:not-allowed;background-color:transparent}.nav .open>a,.nav .open>a:focus,.nav .open>a:hover{background-color:#eee;border-color:#337ab7}.nav .nav-divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.nav>li>a>img{max-width:none}.nav-tabs{border-bottom:1px solid #ddd}.nav-tabs>li{float:left;margin-bottom:-1px}.nav-tabs>li>a{margin-right:2px;line-height:1.42857143;border:1px solid transparent;border-radius:4px 4px 0 0}.nav-tabs>li>a:hover{border-color:#eee #eee #ddd}.nav-tabs>li.active>a,.nav-tabs>li.active>a:focus,.nav-tabs>li.active>a:hover{color:#555;cursor:default;background-color:#fff;border:1px solid #ddd;border-bottom-color:transparent}.nav-tabs.nav-justified{width:100%;border-bottom:0}.nav-tabs.nav-justified>li{float:none}.nav-tabs.nav-justified>li>a{margin-bottom:5px;text-align:center}.nav-tabs.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-tabs.nav-justified>li{display:table-cell;width:1%}.nav-tabs.nav-justified>li>a{margin-bottom:0}}.nav-tabs.nav-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:focus,.nav-tabs.nav-justified>.active>a:hover{border:1px solid #ddd}@media (min-width:768px){.nav-tabs.nav-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:focus,.nav-tabs.nav-justified>.active>a:hover{border-bottom-color:#fff}}.nav-pills>li{float:left}.nav-pills>li>a{border-radius:4px}.nav-pills>li+li{margin-left:2px}.nav-pills>li.active>a,.nav-pills>li.active>a:focus,.nav-pills>li.active>a:hover{color:#fff;background-color:#337ab7}.nav-stacked>li{float:none}.nav-stacked>li+li{margin-top:2px;margin-left:0}.nav-justified{width:100%}.nav-justified>li{float:none}.nav-justified>li>a{margin-bottom:5px;text-align:center}.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-justified>li{display:table-cell;width:1%}.nav-justified>li>a{margin-bottom:0}}.nav-tabs-justified{border-bottom:0}.nav-tabs-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:focus,.nav-tabs-justified>.active>a:hover{border:1px solid #ddd}@media (min-width:768px){.nav-tabs-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:focus,.nav-tabs-justified>.active>a:hover{border-bottom-color:#fff}}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.nav-tabs .dropdown-menu{margin-top:-1px;border-top-left-radius:0;border-top-right-radius:0}.navbar{position:relative;min-height:50px;margin-bottom:20px;border:1px solid transparent}@media (min-width:768px){.navbar{border-radius:4px}}@media (min-width:768px){.navbar-header{float:left}}.navbar-collapse{padding-right:15px;padding-left:15px;overflow-x:visible;-webkit-overflow-scrolling:touch;border-top:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px 0 rgba(255,255,255,.1)}.navbar-collapse.in{overflow-y:auto}@media (min-width:768px){.navbar-collapse{width:auto;border-top:0;-webkit-box-shadow:none;box-shadow:none}.navbar-collapse.collapse{display:block!important;height:auto!important;padding-bottom:0;overflow:visible!important}.navbar-collapse.in{overflow-y:visible}.navbar-fixed-bottom .navbar-collapse,.navbar-fixed-top .navbar-collapse,.navbar-static-top .navbar-collapse{padding-right:0;padding-left:0}}.navbar-fixed-bottom .navbar-collapse,.navbar-fixed-top .navbar-collapse{max-height:340px}@media (max-device-width:480px)and (orientation:landscape){.navbar-fixed-bottom .navbar-collapse,.navbar-fixed-top .navbar-collapse{max-height:200px}}.container-fluid>.navbar-collapse,.container-fluid>.navbar-header,.container>.navbar-collapse,.container>.navbar-header{margin-right:-15px;margin-left:-15px}@media (min-width:768px){.container-fluid>.navbar-collapse,.container-fluid>.navbar-header,.container>.navbar-collapse,.container>.navbar-header{margin-right:0;margin-left:0}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width:768px){.navbar-static-top{border-radius:0}}.navbar-fixed-bottom,.navbar-fixed-top{position:fixed;right:0;left:0;z-index:1030}@media (min-width:768px){.navbar-fixed-bottom,.navbar-fixed-top{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}.navbar-brand{float:left;height:50px;padding:15px 15px;font-size:18px;line-height:20px}.navbar-brand:focus,.navbar-brand:hover{text-decoration:none}.navbar-brand>img{display:block}@media (min-width:768px){.navbar>.container .navbar-brand,.navbar>.container-fluid .navbar-brand{margin-left:-15px}}.navbar-toggle{position:relative;float:right;padding:9px 10px;margin-top:8px;margin-right:15px;margin-bottom:8px;background-color:transparent;background-image:none;border:1px solid transparent;border-radius:4px}.navbar-toggle:focus{outline:0}.navbar-toggle .icon-bar{display:block;width:22px;height:2px;border-radius:1px}.navbar-toggle .icon-bar+.icon-bar{margin-top:4px}@media (min-width:768px){.navbar-toggle{display:none}}.navbar-nav{margin:7.5px -15px}.navbar-nav>li>a{padding-top:10px;padding-bottom:10px;line-height:20px}@media (max-width:767px){.navbar-nav .open .dropdown-menu{position:static;float:none;width:auto;margin-top:0;background-color:transparent;border:0;-webkit-box-shadow:none;box-shadow:none}.navbar-nav .open .dropdown-menu .dropdown-header,.navbar-nav .open .dropdown-menu>li>a{padding:5px 15px 5px 25px}.navbar-nav .open .dropdown-menu>li>a{line-height:20px}.navbar-nav .open .dropdown-menu>li>a:focus,.navbar-nav .open .dropdown-menu>li>a:hover{background-image:none}}@media (min-width:768px){.navbar-nav{float:left;margin:0}.navbar-nav>li{float:left}.navbar-nav>li>a{padding-top:15px;padding-bottom:15px}}.navbar-form{padding:10px 15px;margin-top:8px;margin-right:-15px;margin-bottom:8px;margin-left:-15px;border-top:1px solid transparent;border-bottom:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 1px 0 rgba(255,255,255,.1)}@media (min-width:768px){.navbar-form .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.navbar-form .form-control{display:inline-block;width:auto;vertical-align:middle}.navbar-form .form-control-static{display:inline-block}.navbar-form .input-group{display:inline-table;vertical-align:middle}.navbar-form .input-group .form-control,.navbar-form .input-group .input-group-addon,.navbar-form .input-group .input-group-btn{width:auto}.navbar-form .input-group>.form-control{width:100%}.navbar-form .control-label{margin-bottom:0;vertical-align:middle}.navbar-form .checkbox,.navbar-form .radio{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.navbar-form .checkbox label,.navbar-form .radio label{padding-left:0}.navbar-form .checkbox input[type=checkbox],.navbar-form .radio input[type=radio]{position:relative;margin-left:0}.navbar-form .has-feedback .form-control-feedback{top:0}}@media (max-width:767px){.navbar-form .form-group{margin-bottom:5px}.navbar-form .form-group:last-child{margin-bottom:0}}@media (min-width:768px){.navbar-form{width:auto;padding-top:0;padding-bottom:0;margin-right:0;margin-left:0;border:0;-webkit-box-shadow:none;box-shadow:none}}.navbar-nav>li>.dropdown-menu{margin-top:0;border-top-left-radius:0;border-top-right-radius:0}.navbar-fixed-bottom .navbar-nav>li>.dropdown-menu{margin-bottom:0;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-btn{margin-top:8px;margin-bottom:8px}.navbar-btn.btn-sm{margin-top:10px;margin-bottom:10px}.navbar-btn.btn-xs{margin-top:14px;margin-bottom:14px}.navbar-text{margin-top:15px;margin-bottom:15px}@media (min-width:768px){.navbar-text{float:left;margin-right:15px;margin-left:15px}}@media (min-width:768px){.navbar-left{float:left!important}.navbar-right{float:right!important;margin-right:-15px}.navbar-right~.navbar-right{margin-right:0}}.navbar-default{background-color:#f8f8f8;border-color:#e7e7e7}.navbar-default .navbar-brand{color:#777}.navbar-default .navbar-brand:focus,.navbar-default .navbar-brand:hover{color:#5e5e5e;background-color:transparent}.navbar-default .navbar-text{color:#777}.navbar-default .navbar-nav>li>a{color:#777}.navbar-default .navbar-nav>li>a:focus,.navbar-default .navbar-nav>li>a:hover{color:#333;background-color:transparent}.navbar-default .navbar-nav>.active>a,.navbar-default .navbar-nav>.active>a:focus,.navbar-default .navbar-nav>.active>a:hover{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav>.disabled>a,.navbar-default .navbar-nav>.disabled>a:focus,.navbar-default .navbar-nav>.disabled>a:hover{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#ddd}.navbar-default .navbar-toggle:focus,.navbar-default .navbar-toggle:hover{background-color:#ddd}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#e7e7e7}.navbar-default .navbar-nav>.open>a,.navbar-default .navbar-nav>.open>a:focus,.navbar-default .navbar-nav>.open>a:hover{color:#555;background-color:#e7e7e7}@media (max-width:767px){.navbar-default .navbar-nav .open .dropdown-menu>li>a{color:#777}.navbar-default .navbar-nav .open .dropdown-menu>li>a:focus,.navbar-default .navbar-nav .open .dropdown-menu>li>a:hover{color:#333;background-color:transparent}.navbar-default .navbar-nav .open .dropdown-menu>.active>a,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:focus,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:hover{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:focus,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:hover{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#777}.navbar-default .navbar-link:hover{color:#333}.navbar-default .btn-link{color:#777}.navbar-default .btn-link:focus,.navbar-default .btn-link:hover{color:#333}.navbar-default .btn-link[disabled]:focus,.navbar-default .btn-link[disabled]:hover,fieldset[disabled] .navbar-default .btn-link:focus,fieldset[disabled] .navbar-default .btn-link:hover{color:#ccc}.navbar-inverse{background-color:#222;border-color:#080808}.navbar-inverse .navbar-brand{color:#9d9d9d}.navbar-inverse .navbar-brand:focus,.navbar-inverse .navbar-brand:hover{color:#fff;background-color:transparent}.navbar-inverse .navbar-text{color:#9d9d9d}.navbar-inverse .navbar-nav>li>a{color:#9d9d9d}.navbar-inverse .navbar-nav>li>a:focus,.navbar-inverse .navbar-nav>li>a:hover{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav>.active>a,.navbar-inverse .navbar-nav>.active>a:focus,.navbar-inverse .navbar-nav>.active>a:hover{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav>.disabled>a,.navbar-inverse .navbar-nav>.disabled>a:focus,.navbar-inverse .navbar-nav>.disabled>a:hover{color:#444;background-color:transparent}.navbar-inverse .navbar-toggle{border-color:#333}.navbar-inverse .navbar-toggle:focus,.navbar-inverse .navbar-toggle:hover{background-color:#333}.navbar-inverse .navbar-toggle .icon-bar{background-color:#fff}.navbar-inverse .navbar-collapse,.navbar-inverse .navbar-form{border-color:#101010}.navbar-inverse .navbar-nav>.open>a,.navbar-inverse .navbar-nav>.open>a:focus,.navbar-inverse .navbar-nav>.open>a:hover{color:#fff;background-color:#080808}@media (max-width:767px){.navbar-inverse .navbar-nav .open .dropdown-menu>.dropdown-header{border-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu .divider{background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a{color:#9d9d9d}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:focus,.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:hover{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:focus,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:hover{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:focus,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:hover{color:#444;background-color:transparent}}.navbar-inverse .navbar-link{color:#9d9d9d}.navbar-inverse .navbar-link:hover{color:#fff}.navbar-inverse .btn-link{color:#9d9d9d}.navbar-inverse .btn-link:focus,.navbar-inverse .btn-link:hover{color:#fff}.navbar-inverse .btn-link[disabled]:focus,.navbar-inverse .btn-link[disabled]:hover,fieldset[disabled] .navbar-inverse .btn-link:focus,fieldset[disabled] .navbar-inverse .btn-link:hover{color:#444}.breadcrumb{padding:8px 15px;margin-bottom:20px;list-style:none;background-color:#f5f5f5;border-radius:4px}.breadcrumb>li{display:inline-block}.breadcrumb>li+li:before{padding:0 5px;color:#ccc;content:"/\00a0"}.breadcrumb>.active{color:#777}.pagination{display:inline-block;padding-left:0;margin:20px 0;border-radius:4px}.pagination>li{display:inline}.pagination>li>a,.pagination>li>span{position:relative;float:left;padding:6px 12px;margin-left:-1px;line-height:1.42857143;color:#337ab7;text-decoration:none;background-color:#fff;border:1px solid #ddd}.pagination>li:first-child>a,.pagination>li:first-child>span{margin-left:0;border-top-left-radius:4px;border-bottom-left-radius:4px}.pagination>li:last-child>a,.pagination>li:last-child>span{border-top-right-radius:4px;border-bottom-right-radius:4px}.pagination>li>a:focus,.pagination>li>a:hover,.pagination>li>span:focus,.pagination>li>span:hover{color:#23527c;background-color:#eee;border-color:#ddd}.pagination>.active>a,.pagination>.active>a:focus,.pagination>.active>a:hover,.pagination>.active>span,.pagination>.active>span:focus,.pagination>.active>span:hover{z-index:2;color:#fff;cursor:default;background-color:#337ab7;border-color:#337ab7}.pagination>.disabled>a,.pagination>.disabled>a:focus,.pagination>.disabled>a:hover,.pagination>.disabled>span,.pagination>.disabled>span:focus,.pagination>.disabled>span:hover{color:#777;cursor:not-allowed;background-color:#fff;border-color:#ddd}.pagination-lg>li>a,.pagination-lg>li>span{padding:10px 16px;font-size:18px}.pagination-lg>li:first-child>a,.pagination-lg>li:first-child>span{border-top-left-radius:6px;border-bottom-left-radius:6px}.pagination-lg>li:last-child>a,.pagination-lg>li:last-child>span{border-top-right-radius:6px;border-bottom-right-radius:6px}.pagination-sm>li>a,.pagination-sm>li>span{padding:5px 10px;font-size:12px}.pagination-sm>li:first-child>a,.pagination-sm>li:first-child>span{border-top-left-radius:3px;border-bottom-left-radius:3px}.pagination-sm>li:last-child>a,.pagination-sm>li:last-child>span{border-top-right-radius:3px;border-bottom-right-radius:3px}.pager{padding-left:0;margin:20px 0;text-align:center;list-style:none}.pager li{display:inline}.pager li>a,.pager li>span{display:inline-block;padding:5px 14px;background-color:#fff;border:1px solid #ddd;border-radius:15px}.pager li>a:focus,.pager li>a:hover{text-decoration:none;background-color:#eee}.pager .next>a,.pager .next>span{float:right}.pager .previous>a,.pager .previous>span{float:left}.pager .disabled>a,.pager .disabled>a:focus,.pager .disabled>a:hover,.pager .disabled>span{color:#777;cursor:not-allowed;background-color:#fff}.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:focus,a.label:hover{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:focus,.label-default[href]:hover{background-color:#5e5e5e}.label-primary{background-color:#337ab7}.label-primary[href]:focus,.label-primary[href]:hover{background-color:#286090}.label-success{background-color:#5cb85c}.label-success[href]:focus,.label-success[href]:hover{background-color:#449d44}.label-info{background-color:#5bc0de}.label-info[href]:focus,.label-info[href]:hover{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:focus,.label-warning[href]:hover{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:focus,.label-danger[href]:hover{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:12px;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;background-color:#777;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-group-xs>.btn .badge,.btn-xs .badge{top:0;padding:1px 5px}a.badge:focus,a.badge:hover{color:#fff;text-decoration:none;cursor:pointer}.list-group-item.active>.badge,.nav-pills>.active>a>.badge{color:#337ab7;background-color:#fff}.list-group-item>.badge{float:right}.list-group-item>.badge+.badge{margin-right:5px}.nav-pills>li>a>.badge{margin-left:3px}.jumbotron{padding:30px 15px;margin-bottom:30px;color:inherit;background-color:#eee}.jumbotron .h1,.jumbotron h1{color:inherit}.jumbotron p{margin-bottom:15px;font-size:21px;font-weight:200}.jumbotron>hr{border-top-color:#d5d5d5}.container .jumbotron,.container-fluid .jumbotron{border-radius:6px}.jumbotron .container{max-width:100%}@media screen and (min-width:768px){.jumbotron{padding:48px 0}.container .jumbotron,.container-fluid .jumbotron{padding-right:60px;padding-left:60px}.jumbotron .h1,.jumbotron h1{font-size:63px}}.thumbnail{display:block;padding:4px;margin-bottom:20px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:border .2s ease-in-out;-o-transition:border .2s ease-in-out;transition:border .2s ease-in-out}.thumbnail a>img,.thumbnail>img{margin-right:auto;margin-left:auto}a.thumbnail.active,a.thumbnail:focus,a.thumbnail:hover{border-color:#337ab7}.thumbnail .caption{padding:9px;color:#333}.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert h4{margin-top:0;color:inherit}.alert .alert-link{font-weight:700}.alert>p,.alert>ul{margin-bottom:0}.alert>p+p{margin-top:5px}.alert-dismissable,.alert-dismissible{padding-right:35px}.alert-dismissable .close,.alert-dismissible .close{position:relative;top:-2px;right:-21px;color:inherit}.alert-success{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.alert-success hr{border-top-color:#c9e2b3}.alert-success .alert-link{color:#2b542c}.alert-info{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.alert-info hr{border-top-color:#a6e1ec}.alert-info .alert-link{color:#245269}.alert-warning{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.alert-warning hr{border-top-color:#f7e1b5}.alert-warning .alert-link{color:#66512c}.alert-danger{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.alert-danger hr{border-top-color:#e4b9c0}.alert-danger .alert-link{color:#843534}@-webkit-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@-o-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}.progress{height:20px;margin-bottom:20px;overflow:hidden;background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);box-shadow:inset 0 1px 2px rgba(0,0,0,.1)}.progress-bar{float:left;width:0;height:100%;font-size:12px;line-height:20px;color:#fff;text-align:center;background-color:#337ab7;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.15);box-shadow:inset 0 -1px 0 rgba(0,0,0,.15);-webkit-transition:width .6s ease;-o-transition:width .6s ease;transition:width .6s ease}.progress-bar-striped,.progress-striped .progress-bar{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);-webkit-background-size:40px 40px;background-size:40px 40px}.progress-bar.active,.progress.active .progress-bar{-webkit-animation:progress-bar-stripes 2s linear infinite;-o-animation:progress-bar-stripes 2s linear infinite;animation:progress-bar-stripes 2s linear infinite}.progress-bar-success{background-color:#5cb85c}.progress-striped .progress-bar-success{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-info{background-color:#5bc0de}.progress-striped .progress-bar-info{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-warning{background-color:#f0ad4e}.progress-striped .progress-bar-warning{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-danger{background-color:#d9534f}.progress-striped .progress-bar-danger{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.media{margin-top:15px}.media:first-child{margin-top:0}.media,.media-body{overflow:hidden;zoom:1}.media-body{width:10000px}.media-object{display:block}.media-right,.media>.pull-right{padding-left:10px}.media-left,.media>.pull-left{padding-right:10px}.media-body,.media-left,.media-right{display:table-cell;vertical-align:top}.media-middle{vertical-align:middle}.media-bottom{vertical-align:bottom}.media-heading{margin-top:0;margin-bottom:5px}.media-list{padding-left:0;list-style:none}.list-group{padding-left:0;margin-bottom:20px}.list-group-item{position:relative;display:block;padding:10px 15px;margin-bottom:-1px;background-color:#fff;border:1px solid #ddd}.list-group-item:first-child{border-top-left-radius:4px;border-top-right-radius:4px}.list-group-item:last-child{margin-bottom:0;border-bottom-right-radius:4px;border-bottom-left-radius:4px}a.list-group-item{color:#555}a.list-group-item .list-group-item-heading{color:#333}a.list-group-item:focus,a.list-group-item:hover{color:#555;text-decoration:none;background-color:#f5f5f5}.list-group-item.disabled,.list-group-item.disabled:focus,.list-group-item.disabled:hover{color:#777;cursor:not-allowed;background-color:#eee}.list-group-item.disabled .list-group-item-heading,.list-group-item.disabled:focus .list-group-item-heading,.list-group-item.disabled:hover .list-group-item-heading{color:inherit}.list-group-item.disabled .list-group-item-text,.list-group-item.disabled:focus .list-group-item-text,.list-group-item.disabled:hover .list-group-item-text{color:#777}.list-group-item.active,.list-group-item.active:focus,.list-group-item.active:hover{z-index:2;color:#fff;background-color:#337ab7;border-color:#337ab7}.list-group-item.active .list-group-item-heading,.list-group-item.active .list-group-item-heading>.small,.list-group-item.active .list-group-item-heading>small,.list-group-item.active:focus .list-group-item-heading,.list-group-item.active:focus .list-group-item-heading>.small,.list-group-item.active:focus .list-group-item-heading>small,.list-group-item.active:hover .list-group-item-heading,.list-group-item.active:hover .list-group-item-heading>.small,.list-group-item.active:hover .list-group-item-heading>small{color:inherit}.list-group-item.active .list-group-item-text,.list-group-item.active:focus .list-group-item-text,.list-group-item.active:hover .list-group-item-text{color:#c7ddef}.list-group-item-success{color:#3c763d;background-color:#dff0d8}a.list-group-item-success{color:#3c763d}a.list-group-item-success .list-group-item-heading{color:inherit}a.list-group-item-success:focus,a.list-group-item-success:hover{color:#3c763d;background-color:#d0e9c6}a.list-group-item-success.active,a.list-group-item-success.active:focus,a.list-group-item-success.active:hover{color:#fff;background-color:#3c763d;border-color:#3c763d}.list-group-item-info{color:#31708f;background-color:#d9edf7}a.list-group-item-info{color:#31708f}a.list-group-item-info .list-group-item-heading{color:inherit}a.list-group-item-info:focus,a.list-group-item-info:hover{color:#31708f;background-color:#c4e3f3}a.list-group-item-info.active,a.list-group-item-info.active:focus,a.list-group-item-info.active:hover{color:#fff;background-color:#31708f;border-color:#31708f}.list-group-item-warning{color:#8a6d3b;background-color:#fcf8e3}a.list-group-item-warning{color:#8a6d3b}a.list-group-item-warning .list-group-item-heading{color:inherit}a.list-group-item-warning:focus,a.list-group-item-warning:hover{color:#8a6d3b;background-color:#faf2cc}a.list-group-item-warning.active,a.list-group-item-warning.active:focus,a.list-group-item-warning.active:hover{color:#fff;background-color:#8a6d3b;border-color:#8a6d3b}.list-group-item-danger{color:#a94442;background-color:#f2dede}a.list-group-item-danger{color:#a94442}a.list-group-item-danger .list-group-item-heading{color:inherit}a.list-group-item-danger:focus,a.list-group-item-danger:hover{color:#a94442;background-color:#ebcccc}a.list-group-item-danger.active,a.list-group-item-danger.active:focus,a.list-group-item-danger.active:hover{color:#fff;background-color:#a94442;border-color:#a94442}.list-group-item-heading{margin-top:0;margin-bottom:5px}.list-group-item-text{margin-bottom:0;line-height:1.3}.panel{margin-bottom:20px;background-color:#fff;border:1px solid transparent;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0,0,0,.05);box-shadow:0 1px 1px rgba(0,0,0,.05)}.panel-body{padding:15px}.panel-heading{padding:10px 15px;border-bottom:1px solid transparent;border-top-left-radius:3px;border-top-right-radius:3px}.panel-heading>.dropdown .dropdown-toggle{color:inherit}.panel-title{margin-top:0;margin-bottom:0;font-size:16px;color:inherit}.panel-title>.small,.panel-title>.small>a,.panel-title>a,.panel-title>small,.panel-title>small>a{color:inherit}.panel-footer{padding:10px 15px;background-color:#f5f5f5;border-top:1px solid #ddd;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.list-group,.panel>.panel-collapse>.list-group{margin-bottom:0}.panel>.list-group .list-group-item,.panel>.panel-collapse>.list-group .list-group-item{border-width:1px 0;border-radius:0}.panel>.list-group:first-child .list-group-item:first-child,.panel>.panel-collapse>.list-group:first-child .list-group-item:first-child{border-top:0;border-top-left-radius:3px;border-top-right-radius:3px}.panel>.list-group:last-child .list-group-item:last-child,.panel>.panel-collapse>.list-group:last-child .list-group-item:last-child{border-bottom:0;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel-heading+.list-group .list-group-item:first-child{border-top-width:0}.list-group+.panel-footer{border-top-width:0}.panel>.panel-collapse>.table,.panel>.table,.panel>.table-responsive>.table{margin-bottom:0}.panel>.panel-collapse>.table caption,.panel>.table caption,.panel>.table-responsive>.table caption{padding-right:15px;padding-left:15px}.panel>.table-responsive:first-child>.table:first-child,.panel>.table:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child,.panel>.table:first-child>thead:first-child>tr:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:first-child,.panel>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table:first-child>thead:first-child>tr:first-child th:first-child{border-top-left-radius:3px}.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:last-child,.panel>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table:first-child>thead:first-child>tr:first-child th:last-child{border-top-right-radius:3px}.panel>.table-responsive:last-child>.table:last-child,.panel>.table:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:first-child,.panel>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:first-child{border-bottom-left-radius:3px}.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:last-child{border-bottom-right-radius:3px}.panel>.panel-body+.table,.panel>.panel-body+.table-responsive,.panel>.table+.panel-body,.panel>.table-responsive+.panel-body{border-top:1px solid #ddd}.panel>.table>tbody:first-child>tr:first-child td,.panel>.table>tbody:first-child>tr:first-child th{border-top:0}.panel>.table-bordered,.panel>.table-responsive>.table-bordered{border:0}.panel>.table-bordered>tbody>tr>td:first-child,.panel>.table-bordered>tbody>tr>th:first-child,.panel>.table-bordered>tfoot>tr>td:first-child,.panel>.table-bordered>tfoot>tr>th:first-child,.panel>.table-bordered>thead>tr>td:first-child,.panel>.table-bordered>thead>tr>th:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:first-child,.panel>.table-responsive>.table-bordered>thead>tr>td:first-child,.panel>.table-responsive>.table-bordered>thead>tr>th:first-child{border-left:0}.panel>.table-bordered>tbody>tr>td:last-child,.panel>.table-bordered>tbody>tr>th:last-child,.panel>.table-bordered>tfoot>tr>td:last-child,.panel>.table-bordered>tfoot>tr>th:last-child,.panel>.table-bordered>thead>tr>td:last-child,.panel>.table-bordered>thead>tr>th:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:last-child,.panel>.table-responsive>.table-bordered>thead>tr>td:last-child,.panel>.table-responsive>.table-bordered>thead>tr>th:last-child{border-right:0}.panel>.table-bordered>tbody>tr:first-child>td,.panel>.table-bordered>tbody>tr:first-child>th,.panel>.table-bordered>thead>tr:first-child>td,.panel>.table-bordered>thead>tr:first-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>th,.panel>.table-responsive>.table-bordered>thead>tr:first-child>td,.panel>.table-responsive>.table-bordered>thead>tr:first-child>th{border-bottom:0}.panel>.table-bordered>tbody>tr:last-child>td,.panel>.table-bordered>tbody>tr:last-child>th,.panel>.table-bordered>tfoot>tr:last-child>td,.panel>.table-bordered>tfoot>tr:last-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>th,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>td,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>th{border-bottom:0}.panel>.table-responsive{margin-bottom:0;border:0}.panel-group{margin-bottom:20px}.panel-group .panel{margin-bottom:0;border-radius:4px}.panel-group .panel+.panel{margin-top:5px}.panel-group .panel-heading{border-bottom:0}.panel-group .panel-heading+.panel-collapse>.list-group,.panel-group .panel-heading+.panel-collapse>.panel-body{border-top:1px solid #ddd}.panel-group .panel-footer{border-top:0}.panel-group .panel-footer+.panel-collapse .panel-body{border-bottom:1px solid #ddd}.panel-default{border-color:#ddd}.panel-default>.panel-heading{color:#333;background-color:#f5f5f5;border-color:#ddd}.panel-default>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ddd}.panel-default>.panel-heading .badge{color:#f5f5f5;background-color:#333}.panel-default>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ddd}.panel-primary{border-color:#337ab7}.panel-primary>.panel-heading{color:#fff;background-color:#337ab7;border-color:#337ab7}.panel-primary>.panel-heading+.panel-collapse>.panel-body{border-top-color:#337ab7}.panel-primary>.panel-heading .badge{color:#337ab7;background-color:#fff}.panel-primary>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#337ab7}.panel-success{border-color:#d6e9c6}.panel-success>.panel-heading{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.panel-success>.panel-heading+.panel-collapse>.panel-body{border-top-color:#d6e9c6}.panel-success>.panel-heading .badge{color:#dff0d8;background-color:#3c763d}.panel-success>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#d6e9c6}.panel-info{border-color:#bce8f1}.panel-info>.panel-heading{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.panel-info>.panel-heading+.panel-collapse>.panel-body{border-top-color:#bce8f1}.panel-info>.panel-heading .badge{color:#d9edf7;background-color:#31708f}.panel-info>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#bce8f1}.panel-warning{border-color:#faebcc}.panel-warning>.panel-heading{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.panel-warning>.panel-heading+.panel-collapse>.panel-body{border-top-color:#faebcc}.panel-warning>.panel-heading .badge{color:#fcf8e3;background-color:#8a6d3b}.panel-warning>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#faebcc}.panel-danger{border-color:#ebccd1}.panel-danger>.panel-heading{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.panel-danger>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ebccd1}.panel-danger>.panel-heading .badge{color:#f2dede;background-color:#a94442}.panel-danger>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ebccd1}.embed-responsive{position:relative;display:block;height:0;padding:0;overflow:hidden}.embed-responsive .embed-responsive-item,.embed-responsive embed,.embed-responsive iframe,.embed-responsive object,.embed-responsive video{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0}.embed-responsive-16by9{padding-bottom:56.25%}.embed-responsive-4by3{padding-bottom:75%}.well{min-height:20px;padding:19px;margin-bottom:20px;background-color:#f5f5f5;border:1px solid #e3e3e3;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.05);box-shadow:inset 0 1px 1px rgba(0,0,0,.05)}.well blockquote{border-color:#ddd;border-color:rgba(0,0,0,.15)}.well-lg{padding:24px;border-radius:6px}.well-sm{padding:9px;border-radius:3px}.close{float:right;font-size:21px;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;filter:alpha(opacity=20);opacity:.2}.close:focus,.close:hover{color:#000;text-decoration:none;cursor:pointer;filter:alpha(opacity=50);opacity:.5}button.close{-webkit-appearance:none;padding:0;cursor:pointer;background:0 0;border:0}.modal-open{overflow:hidden}.modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1050;display:none;overflow:hidden;-webkit-overflow-scrolling:touch;outline:0}.modal.fade .modal-dialog{-webkit-transition:-webkit-transform .3s ease-out;-o-transition:-o-transform .3s ease-out;transition:transform .3s ease-out;-webkit-transform:translate(0,-25%);-ms-transform:translate(0,-25%);-o-transform:translate(0,-25%);transform:translate(0,-25%)}.modal.in .modal-dialog{-webkit-transform:translate(0,0);-ms-transform:translate(0,0);-o-transform:translate(0,0);transform:translate(0,0)}.modal-open .modal{overflow-x:hidden;overflow-y:auto}.modal-dialog{position:relative;width:auto;margin:10px}.modal-content{position:relative;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #999;border:1px solid rgba(0,0,0,.2);border-radius:6px;outline:0;-webkit-box-shadow:0 3px 9px rgba(0,0,0,.5);box-shadow:0 3px 9px rgba(0,0,0,.5)}.modal-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040;background-color:#000}.modal-backdrop.fade{filter:alpha(opacity=0);opacity:0}.modal-backdrop.in{filter:alpha(opacity=50);opacity:.5}.modal-header{min-height:16.43px;padding:15px;border-bottom:1px solid #e5e5e5}.modal-header .close{margin-top:-2px}.modal-title{margin:0;line-height:1.42857143}.modal-body{position:relative;padding:15px}.modal-footer{padding:15px;text-align:right;border-top:1px solid #e5e5e5}.modal-footer .btn+.btn{margin-bottom:0;margin-left:5px}.modal-footer .btn-group .btn+.btn{margin-left:-1px}.modal-footer .btn-block+.btn-block{margin-left:0}.modal-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}@media (min-width:768px){.modal-dialog{width:600px;margin:30px auto}.modal-content{-webkit-box-shadow:0 5px 15px rgba(0,0,0,.5);box-shadow:0 5px 15px rgba(0,0,0,.5)}.modal-sm{width:300px}}@media (min-width:992px){.modal-lg{width:900px}}.tooltip{position:absolute;z-index:1070;display:block;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:12px;font-weight:400;line-height:1.4;filter:alpha(opacity=0);opacity:0}.tooltip.in{filter:alpha(opacity=90);opacity:.9}.tooltip.top{padding:5px 0;margin-top:-3px}.tooltip.right{padding:0 5px;margin-left:3px}.tooltip.bottom{padding:5px 0;margin-top:3px}.tooltip.left{padding:0 5px;margin-left:-3px}.tooltip-inner{max-width:200px;padding:3px 8px;color:#fff;text-align:center;text-decoration:none;background-color:#000;border-radius:4px}.tooltip-arrow{position:absolute;width:0;height:0;border-color:transparent;border-style:solid}.tooltip.top .tooltip-arrow{bottom:0;left:50%;margin-left:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.top-left .tooltip-arrow{right:5px;bottom:0;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.top-right .tooltip-arrow{bottom:0;left:5px;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.right .tooltip-arrow{top:50%;left:0;margin-top:-5px;border-width:5px 5px 5px 0;border-right-color:#000}.tooltip.left .tooltip-arrow{top:50%;right:0;margin-top:-5px;border-width:5px 0 5px 5px;border-left-color:#000}.tooltip.bottom .tooltip-arrow{top:0;left:50%;margin-left:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip.bottom-left .tooltip-arrow{top:0;right:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip.bottom-right .tooltip-arrow{top:0;left:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#000}.popover{position:absolute;top:0;left:0;z-index:1060;display:none;max-width:276px;padding:1px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;font-weight:400;line-height:1.42857143;text-align:left;white-space:normal;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,.2);border-radius:6px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,.2);box-shadow:0 5px 10px rgba(0,0,0,.2)}.popover.top{margin-top:-10px}.popover.right{margin-left:10px}.popover.bottom{margin-top:10px}.popover.left{margin-left:-10px}.popover-title{padding:8px 14px;margin:0;font-size:14px;background-color:#f7f7f7;border-bottom:1px solid #ebebeb;border-radius:5px 5px 0 0}.popover-content{padding:9px 14px}.popover>.arrow,.popover>.arrow:after{position:absolute;display:block;width:0;height:0;border-color:transparent;border-style:solid}.popover>.arrow{border-width:11px}.popover>.arrow:after{content:"";border-width:10px}.popover.top>.arrow{bottom:-11px;left:50%;margin-left:-11px;border-top-color:#999;border-top-color:rgba(0,0,0,.25);border-bottom-width:0}.popover.top>.arrow:after{bottom:1px;margin-left:-10px;content:" ";border-top-color:#fff;border-bottom-width:0}.popover.right>.arrow{top:50%;left:-11px;margin-top:-11px;border-right-color:#999;border-right-color:rgba(0,0,0,.25);border-left-width:0}.popover.right>.arrow:after{bottom:-10px;left:1px;content:" ";border-right-color:#fff;border-left-width:0}.popover.bottom>.arrow{top:-11px;left:50%;margin-left:-11px;border-top-width:0;border-bottom-color:#999;border-bottom-color:rgba(0,0,0,.25)}.popover.bottom>.arrow:after{top:1px;margin-left:-10px;content:" ";border-top-width:0;border-bottom-color:#fff}.popover.left>.arrow{top:50%;right:-11px;margin-top:-11px;border-right-width:0;border-left-color:#999;border-left-color:rgba(0,0,0,.25)}.popover.left>.arrow:after{right:1px;bottom:-10px;content:" ";border-right-width:0;border-left-color:#fff}.carousel{position:relative}.carousel-inner{position:relative;width:100%;overflow:hidden}.carousel-inner>.item{position:relative;display:none;-webkit-transition:.6s ease-in-out left;-o-transition:.6s ease-in-out left;transition:.6s ease-in-out left}.carousel-inner>.item>a>img,.carousel-inner>.item>img{line-height:1}@media all and (transform-3d),(-webkit-transform-3d){.carousel-inner>.item{-webkit-transition:-webkit-transform .6s ease-in-out;-o-transition:-o-transform .6s ease-in-out;transition:transform .6s ease-in-out;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000;perspective:1000}.carousel-inner>.item.active.right,.carousel-inner>.item.next{left:0;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.carousel-inner>.item.active.left,.carousel-inner>.item.prev{left:0;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.carousel-inner>.item.active,.carousel-inner>.item.next.left,.carousel-inner>.item.prev.right{left:0;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}}.carousel-inner>.active,.carousel-inner>.next,.carousel-inner>.prev{display:block}.carousel-inner>.active{left:0}.carousel-inner>.next,.carousel-inner>.prev{position:absolute;top:0;width:100%}.carousel-inner>.next{left:100%}.carousel-inner>.prev{left:-100%}.carousel-inner>.next.left,.carousel-inner>.prev.right{left:0}.carousel-inner>.active.left{left:-100%}.carousel-inner>.active.right{left:100%}.carousel-control{position:absolute;top:0;bottom:0;left:0;width:15%;font-size:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.6);filter:alpha(opacity=50);opacity:.5}.carousel-control.left{background-image:-webkit-linear-gradient(left,rgba(0,0,0,.5) 0,rgba(0,0,0,.0001) 100%);background-image:-o-linear-gradient(left,rgba(0,0,0,.5) 0,rgba(0,0,0,.0001) 100%);background-image:-webkit-gradient(linear,left top,right top,from(rgba(0,0,0,.5)),to(rgba(0,0,0,.0001)));background-image:linear-gradient(to right,rgba(0,0,0,.5) 0,rgba(0,0,0,.0001) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);background-repeat:repeat-x}.carousel-control.right{right:0;left:auto;background-image:-webkit-linear-gradient(left,rgba(0,0,0,.0001) 0,rgba(0,0,0,.5) 100%);background-image:-o-linear-gradient(left,rgba(0,0,0,.0001) 0,rgba(0,0,0,.5) 100%);background-image:-webkit-gradient(linear,left top,right top,from(rgba(0,0,0,.0001)),to(rgba(0,0,0,.5)));background-image:linear-gradient(to right,rgba(0,0,0,.0001) 0,rgba(0,0,0,.5) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);background-repeat:repeat-x}.carousel-control:focus,.carousel-control:hover{color:#fff;text-decoration:none;filter:alpha(opacity=90);outline:0;opacity:.9}.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next,.carousel-control .icon-prev{position:absolute;top:50%;z-index:5;display:inline-block}.carousel-control .glyphicon-chevron-left,.carousel-control .icon-prev{left:50%;margin-left:-10px}.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next{right:50%;margin-right:-10px}.carousel-control .icon-next,.carousel-control .icon-prev{width:20px;height:20px;margin-top:-10px;font-family:serif;line-height:1}.carousel-control .icon-prev:before{content:'\2039'}.carousel-control .icon-next:before{content:'\203a'}.carousel-indicators{position:absolute;bottom:10px;left:50%;z-index:15;width:60%;padding-left:0;margin-left:-30%;text-align:center;list-style:none}.carousel-indicators li{display:inline-block;width:10px;height:10px;margin:1px;text-indent:-999px;cursor:pointer;background-color:#000 \9;background-color:rgba(0,0,0,0);border:1px solid #fff;border-radius:10px}.carousel-indicators .active{width:12px;height:12px;margin:0;background-color:#fff}.carousel-caption{position:absolute;right:15%;bottom:20px;left:15%;z-index:10;padding-top:20px;padding-bottom:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.6)}.carousel-caption .btn{text-shadow:none}@media screen and (min-width:768px){.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next,.carousel-control .icon-prev{width:30px;height:30px;margin-top:-15px;font-size:30px}.carousel-control .glyphicon-chevron-left,.carousel-control .icon-prev{margin-left:-15px}.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next{margin-right:-15px}.carousel-caption{right:20%;left:20%;padding-bottom:30px}.carousel-indicators{bottom:20px}}.btn-group-vertical>.btn-group:after,.btn-group-vertical>.btn-group:before,.btn-toolbar:after,.btn-toolbar:before,.clearfix:after,.clearfix:before,.container-fluid:after,.container-fluid:before,.container:after,.container:before,.dl-horizontal dd:after,.dl-horizontal dd:before,.form-horizontal .form-group:after,.form-horizontal .form-group:before,.modal-footer:after,.modal-footer:before,.nav:after,.nav:before,.navbar-collapse:after,.navbar-collapse:before,.navbar-header:after,.navbar-header:before,.navbar:after,.navbar:before,.pager:after,.pager:before,.panel-body:after,.panel-body:before,.row:after,.row:before{display:table;content:" "}.btn-group-vertical>.btn-group:after,.btn-toolbar:after,.clearfix:after,.container-fluid:after,.container:after,.dl-horizontal dd:after,.form-horizontal .form-group:after,.modal-footer:after,.nav:after,.navbar-collapse:after,.navbar-header:after,.navbar:after,.pager:after,.panel-body:after,.row:after{clear:both}.center-block{display:block;margin-right:auto;margin-left:auto}.pull-right{float:right!important}.pull-left{float:left!important}.hide{display:none!important}.show{display:block!important}.invisible{visibility:hidden}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.hidden{display:none!important}.affix{position:fixed}@-ms-viewport{width:device-width}.visible-lg,.visible-md,.visible-sm,.visible-xs{display:none!important}.visible-lg-block,.visible-lg-inline,.visible-lg-inline-block,.visible-md-block,.visible-md-inline,.visible-md-inline-block,.visible-sm-block,.visible-sm-inline,.visible-sm-inline-block,.visible-xs-block,.visible-xs-inline,.visible-xs-inline-block{display:none!important}@media (max-width:767px){.visible-xs{display:block!important}table.visible-xs{display:table}tr.visible-xs{display:table-row!important}td.visible-xs,th.visible-xs{display:table-cell!important}}@media (max-width:767px){.visible-xs-block{display:block!important}}@media (max-width:767px){.visible-xs-inline{display:inline!important}}@media (max-width:767px){.visible-xs-inline-block{display:inline-block!important}}@media (min-width:768px)and (max-width:991px){.visible-sm{display:block!important}table.visible-sm{display:table}tr.visible-sm{display:table-row!important}td.visible-sm,th.visible-sm{display:table-cell!important}}@media (min-width:768px)and (max-width:991px){.visible-sm-block{display:block!important}}@media (min-width:768px)and (max-width:991px){.visible-sm-inline{display:inline!important}}@media (min-width:768px)and (max-width:991px){.visible-sm-inline-block{display:inline-block!important}}@media (min-width:992px)and (max-width:1199px){.visible-md{display:block!important}table.visible-md{display:table}tr.visible-md{display:table-row!important}td.visible-md,th.visible-md{display:table-cell!important}}@media (min-width:992px)and (max-width:1199px){.visible-md-block{display:block!important}}@media (min-width:992px)and (max-width:1199px){.visible-md-inline{display:inline!important}}@media (min-width:992px)and (max-width:1199px){.visible-md-inline-block{display:inline-block!important}}@media (min-width:1200px){.visible-lg{display:block!important}table.visible-lg{display:table}tr.visible-lg{display:table-row!important}td.visible-lg,th.visible-lg{display:table-cell!important}}@media (min-width:1200px){.visible-lg-block{display:block!important}}@media (min-width:1200px){.visible-lg-inline{display:inline!important}}@media (min-width:1200px){.visible-lg-inline-block{display:inline-block!important}}@media (max-width:767px){.hidden-xs{display:none!important}}@media (min-width:768px)and (max-width:991px){.hidden-sm{display:none!important}}@media (min-width:992px)and (max-width:1199px){.hidden-md{display:none!important}}@media (min-width:1200px){.hidden-lg{display:none!important}}.visible-print{display:none!important}@media print{.visible-print{display:block!important}table.visible-print{display:table}tr.visible-print{display:table-row!important}td.visible-print,th.visible-print{display:table-cell!important}}.visible-print-block{display:none!important}@media print{.visible-print-block{display:block!important}}.visible-print-inline{display:none!important}@media print{.visible-print-inline{display:inline!important}}.visible-print-inline-block{display:none!important}@media print{.visible-print-inline-block{display:inline-block!important}}@media print{.hidden-print{display:none!important}}</style>

<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>


<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <!-- End of mathjax configuration -->

<style>
td.center, th.center {
    text-align: center;
}

body {
  overflow: visible;
  font-size: 14px;
  padding-top: 1em;
}

div#notebook {
  overflow: visible;
  border-top: none;
}

div#notebook-container {
  width: 100%;
}

@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}

div.prompt {
  min-width: 21ex;
}

div.nbgrader_cell {
    width: 100%;
}

div.nbgrader_cell .panel-heading {
    padding: 0.4em 0.6em;
    height: 37px;
}

div.nbgrader_cell .panel-heading a {
    color: #BBBBBB;
}

div.nbgrader_cell .panel-footer {
    padding: 0.4em 0.6em;
}

div.nbgrader_cell .panel-body {
    padding: 0.4em;
}

.comment {
    width: 100%;
    margin-top: 0.5em;
}

div.nbgrader_cell .input_area {
    background: white;
    border: none;
}

.score {
    color: black;
}

li.late-penalty {
    color: #d2413a;
}

span.nbgrader-label {
    line-height: 25px;
}

.save-icon {
    margin-left: 1em;
    top: 4px;
}
</style>

</head>
<body>
  <a name="top"></a>
  <div class="container">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4>Week3 (Score: 7.0 / 11.0)</h4>
        <div id="toc">
          <ol>
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-task1_test">Test cell</a> (Score: 1.0 / 1.0)</li>
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-0822a1056ab386e0">Test cell</a> (Score: 1.0 / 1.0)</li>
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-8a3ad3d3ffaf0ab6">Test cell</a> (Score: 0.0 / 2.0)</li>
            
            
          
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-e584763198adafe0">Test cell</a> (Score: 1.0 / 1.0)</li>
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-6ebcf0a3441cdf34">Test cell</a> (Score: 1.0 / 1.0)</li>
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-1c220d297c556a99">Test cell</a> (Score: 2.0 / 2.0)</li>
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-8687020d4055d994">Test cell</a> (Score: 1.0 / 1.0)</li>
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-6614804c811b77b5">Test cell</a> (Score: 0.0 / 1.0)</li>
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            <li><a href="#cell-43bdb013d0e9bb1c">Test cell</a> (Score: 0.0 / 1.0)</li>
            
            
          
            
            
          
            
            
          
          
          </ol>
        </div>
      </div>
      <div class="panel-body">
        <div id="notebook" class="border-box-sizing">
          <div class="container" id="notebook-container">
            
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># set to larger value to see all the columns of pd.DF</span>
</pre></div>

    </div>
  </div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>This is programming assignment for week 3. In this assignment you will be practicing with feature selection and hyperparameters tuning.</p>
<p>Please, read all the notebook carefully and make sure that you understand not only the task, but the whole pipeline.</p>
<h3 id="Grading">Grading<a class="anchor-link" href="#Grading">&#182;</a></h3><p>The assignemnt is automatically graded.</p>
<p><strong>Automatic grading</strong>
After you finish solving all the tasks restart the kernel (<code>kernel -&gt; restart</code>) and click the button <code>Validate</code> to check that everything works as expected. Afterwards, you can submit your work.</p>
<h1 id="Table-of-Contents:">Table of Contents:<a class="anchor-link" href="#Table-of-Contents:">&#182;</a></h1><ul>
<li><p><a href="#part1">Problem 1.</a>  Feature selection</p>
<ul>
<li><a href="#task1">Task 1</a> [1 pt]</li>
<li><a href="#task2">Task 2</a> [1 pts]</li>
<li><a href="#task3">Task 3</a> [2 pts]</li>
<li><a href="#task4">Task 4</a> [1 pt]</li>
<li><a href="#task5">Task 5</a> [1 pts]</li>
<li><a href="#task6">Task 6</a> [2 pts]</li>
<li><a href="#task7">Task 7</a> [1 pts]</li>
</ul>
</li>
<li><p><a href="#part2">Problem 2</a>. Hyperparameters Tuning</p>
<ul>
<li><a href="#task2_1">Task 1</a> [1 pts]</li>
<li><a href="#task2_2">Task 2</a> [1 pts]</li>
</ul>
</li>
</ul>
<h2 id="Problem-1.-Feature-selection--">Problem 1. Feature selection  <a class="anchor" id="part1" /><a class="anchor-link" href="#Problem-1.-Feature-selection--">&#182;</a></h2><hr>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>We will work with a Mercedes-Benz Greener Manufacturing dataset and try different feature engineering, feature selection and dimensionality reduction techniques to predict the time Mercedes-Benz cars spend on the test bench.</p>
<p>First, let's load the data and take a look at the dataset. Target variable to predict is y, the time for testing the car in seconds. We will exclude it from the feature set, as well as a column with unique car id, and split the dataset into training and validation samples.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">file_path</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/mbburova/MDS/raw/main/train_mercedes.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>



<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>y</th>
      <th>X0</th>
      <th>X1</th>
      <th>X2</th>
      <th>X3</th>
      <th>X4</th>
      <th>X5</th>
      <th>X6</th>
      <th>X8</th>
      <th>X10</th>
      <th>X11</th>
      <th>X12</th>
      <th>X13</th>
      <th>X14</th>
      <th>X15</th>
      <th>X16</th>
      <th>X17</th>
      <th>X18</th>
      <th>X19</th>
      <th>X20</th>
      <th>X21</th>
      <th>X22</th>
      <th>X23</th>
      <th>X24</th>
      <th>X26</th>
      <th>X27</th>
      <th>X28</th>
      <th>X29</th>
      <th>X30</th>
      <th>X31</th>
      <th>X32</th>
      <th>X33</th>
      <th>X34</th>
      <th>X35</th>
      <th>X36</th>
      <th>X37</th>
      <th>X38</th>
      <th>X39</th>
      <th>X40</th>
      <th>X41</th>
      <th>X42</th>
      <th>X43</th>
      <th>X44</th>
      <th>X45</th>
      <th>X46</th>
      <th>X47</th>
      <th>X48</th>
      <th>X49</th>
      <th>X50</th>
      <th>...</th>
      <th>X335</th>
      <th>X336</th>
      <th>X337</th>
      <th>X338</th>
      <th>X339</th>
      <th>X340</th>
      <th>X341</th>
      <th>X342</th>
      <th>X343</th>
      <th>X344</th>
      <th>X345</th>
      <th>X346</th>
      <th>X347</th>
      <th>X348</th>
      <th>X349</th>
      <th>X350</th>
      <th>X351</th>
      <th>X352</th>
      <th>X353</th>
      <th>X354</th>
      <th>X355</th>
      <th>X356</th>
      <th>X357</th>
      <th>X358</th>
      <th>X359</th>
      <th>X360</th>
      <th>X361</th>
      <th>X362</th>
      <th>X363</th>
      <th>X364</th>
      <th>X365</th>
      <th>X366</th>
      <th>X367</th>
      <th>X368</th>
      <th>X369</th>
      <th>X370</th>
      <th>X371</th>
      <th>X372</th>
      <th>X373</th>
      <th>X374</th>
      <th>X375</th>
      <th>X376</th>
      <th>X377</th>
      <th>X378</th>
      <th>X379</th>
      <th>X380</th>
      <th>X382</th>
      <th>X383</th>
      <th>X384</th>
      <th>X385</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>130.81</td>
      <td>k</td>
      <td>v</td>
      <td>at</td>
      <td>a</td>
      <td>d</td>
      <td>u</td>
      <td>j</td>
      <td>o</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>88.53</td>
      <td>k</td>
      <td>t</td>
      <td>av</td>
      <td>e</td>
      <td>d</td>
      <td>y</td>
      <td>l</td>
      <td>o</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>76.26</td>
      <td>az</td>
      <td>w</td>
      <td>n</td>
      <td>c</td>
      <td>d</td>
      <td>x</td>
      <td>j</td>
      <td>x</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>80.62</td>
      <td>az</td>
      <td>t</td>
      <td>n</td>
      <td>f</td>
      <td>d</td>
      <td>x</td>
      <td>l</td>
      <td>e</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13</td>
      <td>78.02</td>
      <td>az</td>
      <td>v</td>
      <td>n</td>
      <td>f</td>
      <td>d</td>
      <td>h</td>
      <td>d</td>
      <td>n</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 378 columns</p>
</div></div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <h3 id="Baseline-model">Baseline model<a class="anchor-link" href="#Baseline-model">&#182;</a></h3><p>As we can see from a simple exploratory analysis, this dataset contains only categorical and ordinal features. Also, there are no missing values in any features.</p>
<p>Thus, as a very first baseline model, we can just one-hot encode categorical variables and apply linear regression with $l_2$-regularization to predict target variable.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">bin_cols</span> <span class="o">=</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">X_tr</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of binary features =&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_cols</span><span class="p">))</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">X_tr</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of categorical features =&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cat_cols</span><span class="p">))</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of binary features = 368
Number of categorical features = 8
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of columns with any missing values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_tr</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of columns with any missing values:
0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 1.1</strong> [1 pt] <a class="anchor" id="task1"></a></p>
<p>We will evaluate model prediciton quality with $R^2$-score metric. Implement a function to evaluate performance of a given model both on the train and test sets. The function should</p>
<ul>
<li>take as input a model (possibly a pipeline), as well as feature matrix and target variable for both train and test sets,</li>
<li>fit the model on the train set,</li>
<li>compute model predictions for train and test sets,</li>
<li>assess the quality of both predictions with $R^2$ score,</li>
<li>return train and test $R^2$ scores.</li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-task1"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">):</span>
    <span class="c1"># set a fixed random seed for model weights initialization </span>
    <span class="c1"># to obtain reproducible results.</span>
    <span class="c1"># Do not change the value.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">estimator__random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>    

    <span class="c1"># YOUR CODE HERE</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">)</span>
    <span class="n">y_pred_tr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_tr</span><span class="p">)</span>
    <span class="n">y_pred_te</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span>
    <span class="n">R2_tr</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_tr</span><span class="p">,</span> <span class="n">y_pred_tr</span><span class="p">)</span>
    <span class="n">R2_te</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_te</span><span class="p">,</span> <span class="n">y_pred_te</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">R2_tr</span><span class="p">,</span> <span class="n">R2_te</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-task1_test"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-task1_test</code></span>
  <span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="c1"># TEST evaluate_model </span>
<span class="n">res</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">y_tr</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">150</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">y_tr</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">150</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2 on train:&#39;</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2 on test:&#39;</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">Ridge</span><span class="p">(),</span> 
                            <span class="n">X_tr</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">],</span> <span class="n">y_tr</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span>
                            <span class="n">X_tr</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">150</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">],</span> <span class="n">y_tr</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">150</span><span class="p">]),</span> <span class="mi">3</span><span class="p">),</span> 
    <span class="p">[</span><span class="mf">0.136</span><span class="p">,</span> <span class="mf">0.094</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>R2 on train: 0.03454859974270774
R2 on test: -0.02162045646924393
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 1.2</strong> [1 pt] <a class="anchor" id="task2"></a></p>
<p>Initialize the baseline model. It should represent a pipeline including ohe-hot encoding of categorical variables and a <code>Ridge</code> regression (<code>sklearn</code> imlementation of linear regression with $l_2$ regularization) model with default parameters.</p>
<ul>
<li>create <code>col_transformer</code> - ColumnTransformer pipeline with a single transformer - <code>OneHotEncoder</code> applied to categorical columns (<strong>cat_cols</strong>) only. To keep other (binary) features, use <code>remainder=passthrough</code> argument of <code>ColumnTransformer</code>.</li>
<li>create <code>model</code> - Pipeline with two steps:<ul>
<li><strong>col_transformer</strong> you created before (used to encode categorical features)</li>
<li><strong>estimator</strong> should be a <code>Ridge</code> regression with default parameters. <em>Please, make sure that this step is named exactly <strong>estimator</strong>. It will be used in the latter tasks.</em> </li>
</ul>
</li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-f8f2dd66042265d0"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="n">col_transformer</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;ohe&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="n">cat_cols</span><span class="p">)</span>
<span class="p">],</span> <span class="n">remainder</span><span class="o">=</span><span class="s1">&#39;passthrough&#39;</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">col_transformer</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;estimator&#39;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">())</span>
<span class="p">])</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-0822a1056ab386e0"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-0822a1056ab386e0</code></span>
  <span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TEST baseline model</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column transformers:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">col_transformer</span><span class="o">.</span><span class="n">transformers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pipeline:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="c1"># test transformers </span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_transformer</span><span class="o">.</span><span class="n">transformers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;col_transformer should exactly 1 transformation&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_transformer</span><span class="o">.</span><span class="n">transformers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">OneHotEncoder</span><span class="p">),</span> <span class="s1">&#39;col_transformer should use OneHotEncoder&#39;</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">col_transformer</span><span class="o">.</span><span class="n">transformers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">cat_cols</span><span class="p">),</span> <span class="s1">&#39;col_transformer should be applied to all cat_cols&#39;</span>

<span class="c1"># test model pipeline</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ColumnTransformer</span><span class="p">),</span> <span class="s1">&#39;First step of the pipeline should be columns transformer&#39;</span>
<span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;estimator&#39;</span><span class="p">,</span> <span class="s1">&#39;Second step of the pipeline should be named &quot;estimator&quot;&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ridge</span><span class="p">),</span> <span class="s1">&#39;Second step of the pipeline should be Ridge regression&#39;</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Column transformers:
[(&#39;ohe&#39;, OneHotEncoder(handle_unknown=&#39;ignore&#39;), [&#39;X0&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;X4&#39;, &#39;X5&#39;, &#39;X6&#39;, &#39;X8&#39;])]
Pipeline:
(&#39;transform&#39;, ColumnTransformer(remainder=&#39;passthrough&#39;,
                  transformers=[(&#39;ohe&#39;, OneHotEncoder(handle_unknown=&#39;ignore&#39;),
                                 [&#39;X0&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;X4&#39;, &#39;X5&#39;, &#39;X6&#39;,
                                  &#39;X8&#39;])]))
(&#39;estimator&#39;, Ridge())
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Now we can evaluate the baseline model performance:</p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">R2_tr</span><span class="p">,</span> <span class="n">R2_te</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_tr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_te</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train R2 = 0.62
Test R2 = 0.57
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>As we can see, model performance on the training set is slightly higher than on the test data. This can mean that there is overfitting, which is especially likely when number of features is large.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of features before one-hot-encoding: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of features after one-hot-encoding: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">col_transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tr</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of features before one-hot-encoding: 
376

Number of features after one-hot-encoding: 
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>560
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>As we can see, there were quite a lot of features in the original sample, and after the one-hot encoding of categorical variables, their number increased by almost one and a half times.</p>
<p>To avoid overfitting, it can be helpful to reduce the number of variables by selecting the most important ones. In our sample, all the variables are anonymized. However we can still select the most relevant based not on their physical meaning, but on their observed predictive power and informativeness for the model.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <h3 id="Filter-based-methods">Filter-based methods<a class="anchor-link" href="#Filter-based-methods">&#182;</a></h3><!-- ### Univariate feature selection (filter-based methods) -->

<p>The most simple group of feature selection approaches are filter-based methods or univariate feature selection. These methods are based on analysis of individual predictive power of each variable. In our case, since we have a regression problem, we can simply check the correlation of each feature with the target variable.</p>
<p>In <code>sklearn</code>, you can find a ready-to-use implementation of univariate feature selection algorithm - <code>SelectKBest</code> transformer, which filters out a set of <strong>k</strong> features basen on the values of <strong>scoring function</strong>.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 1.3</strong> [2 pts] <a class="anchor" id="task3"></a></p>
<p>Implement a function to compute absolute value of correlation of each feature variable with the target variable.
 The function should:</p>
<ul>
<li>take as input the feature matrix and the target variable,</li>
<li>compute correlation coefficient of each feature in the feature matrix and the target variable,</li>
<li>return a vector of correlation coefficient for all features in the dataset.</li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-e3e09dda53672211"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_abs_corr_coef</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : numpy.ndarray of shape (n_samples, n_features)</span>
<span class="sd">        Feature matrix.</span>
<span class="sd">    y : numpy.ndarray of shape (n_samples,)</span>
<span class="sd">        Target variable</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    corr_coefs : numpy.ndarray of shape (n_features,)</span>
<span class="sd">        Vector of absolute values of correlation coefficients </span>
<span class="sd">        for all features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># YOUR CODE HERE</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-8a3ad3d3ffaf0ab6"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-8a3ad3d3ffaf0ab6</code></span>
  <span class="pull-right">
      Score: 0.0 / 2.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TEST get_abs_corr_coef</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_abs_corr_coef</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">get_abs_corr_coef</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Length of the outut vector should be equal to the number of features&#39;</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">corr</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Function should return absolute values&#39;</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span>       <span class="p">,</span>  <span class="mf">0.86603</span><span class="p">,</span> <span class="mf">0.86603</span><span class="p">]),</span> <span class="s1">&#39;Correlations are not computed correctly&#39;</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[-1.         0.8660254 -0.8660254]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
Input <span class="ansi-green-fg">In [13]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 19&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> corr <span style="color: rgb(98,98,98)">=</span> get_abs_corr_coef(A, b)
<span class="ansi-green-intense-fg ansi-bold">     18</span> <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> <span style="color: rgb(0,135,0)">len</span>(corr) <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(98,98,98)">3</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Length of the outut vector should be equal to the number of features</span><span style="color: rgb(175,0,0)">&#39;</span>
<span class="ansi-green-fg">---&gt; 19</span> <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> np<span style="color: rgb(98,98,98)">.</span>all(corr <span style="color: rgb(98,98,98)">&gt;</span><span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">0</span>), <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Function should return absolute values</span><span style="color: rgb(175,0,0)">&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">     20</span> <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> np<span style="color: rgb(98,98,98)">.</span>allclose(corr, [<span style="color: rgb(98,98,98)">1.</span>       ,  <span style="color: rgb(98,98,98)">0.86603</span>, <span style="color: rgb(98,98,98)">0.86603</span>]), <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Correlations are not computed correctly</span><span style="color: rgb(175,0,0)">&#39;</span>

<span class="ansi-red-fg">AssertionError</span>: Function should return absolute values</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Now we can check how model performance changes if we use only <code>k=60</code> variables with strongest correlation (both positive and negative) with the target variable.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 1.4</strong> [1 pt] <a class="anchor" id="task4"></a></p>
<p>Initialize the model with filter-based feature selection.</p>
<p>Create <code>model_k_best</code> - Pipeline with three steps:</p>
<ul>
<li><strong>col_transformer</strong> that you've created in task 1.2</li>
<li><strong>feat_selector</strong>  - <code>SelectKBest</code> transformer. It should use <code>get_abs_corr_coef</code> scoring function to select <code>30</code> features. </li>
<li><strong>estimator</strong> - <code>Ridge</code> regression with default parameters. <em>Please, make sure that this step is named exactly <strong>estimator</strong>. It will be used in the latter tasks.</em></li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-88ffd9297ff3d54b"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span>
<span class="c1"># from sklearn.feature_selection import chi2, f_regression</span>

<span class="n">feat_selector</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">get_abs_corr_coef</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># YOUR CODE HERE</span>
<span class="n">model_k_best</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">col_transformer</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;selector&#39;</span><span class="p">,</span> <span class="n">feat_selector</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;estimator&#39;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">())</span>
<span class="p">])</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-e584763198adafe0"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-e584763198adafe0</code></span>
  <span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TEST model with filter-based feature selection</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pipeline:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_k_best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_k_best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_k_best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="c1"># test model pipeline</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_k_best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ColumnTransformer</span><span class="p">),</span> <span class="s1">&#39;First step of the pipeline should be columns transformer&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_k_best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">SelectKBest</span><span class="p">),</span> <span class="s1">&#39;Second step of the pipeline should be SelectKBest&#39;</span>
<span class="k">assert</span> <span class="n">model_k_best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;estimator&#39;</span><span class="p">,</span> <span class="s1">&#39;Third step of the pipeline should be named &quot;estimator&quot;&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_k_best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ridge</span><span class="p">),</span> <span class="s1">&#39;Third step of the pipeline should be Ridge regression&#39;</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline:
(&#39;transform&#39;, ColumnTransformer(remainder=&#39;passthrough&#39;,
                  transformers=[(&#39;ohe&#39;, OneHotEncoder(handle_unknown=&#39;ignore&#39;),
                                 [&#39;X0&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;X4&#39;, &#39;X5&#39;, &#39;X6&#39;,
                                  &#39;X8&#39;])]))
(&#39;selector&#39;, SelectKBest(k=20, score_func=&lt;function get_abs_corr_coef at 0x7feb46912700&gt;))
(&#39;estimator&#39;, Ridge())
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">R2_tr_kbest</span><span class="p">,</span> <span class="n">R2_te_kbest</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">model_k_best</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_tr_kbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_te_kbest</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train R2 = 0.50
Test R2 = 0.54
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <h3 id="Wrapper-methods">Wrapper methods<a class="anchor-link" href="#Wrapper-methods">&#182;</a></h3><p>In wrapper methods, feature selection process is based on the greedy search.  Different combinations of features are evaluated and compared using the evaluation criterion, which is simply the performance of the trained model, measured with any appropriated score.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Sklearn has a ready-to-use implementation of a wrapper feature selection algorithm called <strong>Recursive Feature Elimination</strong> (RFE).</p>
<p>The algorithm works by iteratively eliminating features which turned out to be least important based on their weights (or other importance scores) in the trained model. For instance, if the linear regression is used as a base algorithm in selection process, the model is first trained on the whole feature set. Then, the features with smallest weights (coefficients) are excluded, and the model is re-trained on the remaining feature set. The process is repeated until the desired number of features is reached.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 1.5</strong> [1 pt] <a class="anchor" id="task5"></a></p>
<p>Initialize the model with Recursive Feature Elimination method for feature selection.</p>
<p>Create <code>model_rfe</code> - Pipeline with three steps:</p>
<ul>
<li><strong>col_transformer</strong> that you've created in task 1.2</li>
<li><strong>feat_selector</strong>  - <code>RFE</code> transformer. It should use <code>Ridge</code> regression with default parameters as an internal estimator to select <code>20</code> features. </li>
<li><strong>estimator</strong> - <code>Ridge</code> regression with default parameters. </li>
</ul>
<p><em>Note, that instance of Ridge regression used in <code>RFE</code> transformer should not be the same used as estimator. You need 2 independent instances of th esame model.</em></p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-868f855ab31ed1c0"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">RFE</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="n">model_rfe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">col_transformer</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;selector&#39;</span><span class="p">,</span> <span class="n">RFE</span><span class="p">(</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">n_features_to_select</span><span class="o">=</span><span class="mi">20</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;estimator&#39;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">()),</span>
<span class="p">])</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-6ebcf0a3441cdf34"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-6ebcf0a3441cdf34</code></span>
  <span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TEST model with wrapper feature selection</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pipeline:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="c1"># test model pipeline</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ColumnTransformer</span><span class="p">),</span> <span class="s1">&#39;First step of the pipeline should be columns transformer&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">RFE</span><span class="p">),</span> <span class="s1">&#39;Second step of the pipeline should be RFE&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">),</span> <span class="s1">&#39;RFE should use Ridge as an estimator&#39;</span>
<span class="k">assert</span> <span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n_features_to_select</span> <span class="o">==</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;RFE should select 30 features&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_rfe</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ridge</span><span class="p">),</span> <span class="s1">&#39;Third step of the pipeline should be Ridge regression&#39;</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline:
(&#39;transform&#39;, ColumnTransformer(remainder=&#39;passthrough&#39;,
                  transformers=[(&#39;ohe&#39;, OneHotEncoder(handle_unknown=&#39;ignore&#39;),
                                 [&#39;X0&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;X4&#39;, &#39;X5&#39;, &#39;X6&#39;,
                                  &#39;X8&#39;])]))
(&#39;selector&#39;, RFE(estimator=Ridge(), n_features_to_select=20))
(&#39;estimator&#39;, Ridge())
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Evaluate the model (it may take some time).</p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">R2_tr_rfe</span><span class="p">,</span> <span class="n">R2_te_rfe</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">model_rfe</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_tr_rfe</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_te_rfe</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train R2 = 0.54
Test R2 = 0.57
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Two widely used wrapper feature selection approaches a <strong>Forward</strong> and <strong>Backward</strong> sequential feature selection.</p>
<p>In <strong>Forward feature selection</strong> method, one starts from an empty set of selected features. Then, in each iteration, the feature that improves the model performance most is added to the feature set. The process continues until desired number of features is achieved or an addition of a new feature does not improve the model performance.</p>
<p>In <strong>Backward feature selection</strong> method, one starts from the set of all features and iteratively removes the feature, the elimination of which improves the model performance most. Again, the process continues until desired number of features is achieved or an elimination of another feature does not improve the model performance.</p>
<p>In the cases when number of feature is very large, and number of informative ones is expected to be considerably smaller, backward feature selection algorithm can take very long time to converge, and forward feature selection is usually preferred.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 1.6</strong> [2 pts] <a class="anchor" id="task6"></a></p>
<p>Implement a transformer class to perform forward feature selection of a predefined number of features.</p>
<ul>
<li>Start from an <strong>empty</strong> set of <strong>selected features</strong>. </li>
<li>At each step, train the model on the current set of selected features and one of the yet not selected features - <strong>candidate features</strong>. Score model either on the training, or on validation set and collect model scores for all candidate features.</li>
<li>Select from candidate features the feature, that improved model performance most, add it to the set of selected features and eliminate from candidate features.</li>
<li>Repeat until the desired number of selected features is achieved.</li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-412fe35573be7e79"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">TransformerMixin</span><span class="p">,</span> <span class="n">BaseEstimator</span>

<span class="k">class</span> <span class="nc">ForwardFeatureSelection</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects features by iteratively adding the features </span>
<span class="sd">    which provides the highest model score.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    estimator : object</span>
<span class="sd">        A supervised learning estimator with ``fit`` and ``score`` methods.</span>
<span class="sd">    n_features_to_select : int </span>
<span class="sd">        The number of features to select.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">estimator</span><span class="p">,</span>
                 <span class="n">n_features_to_select</span><span class="p">,</span>
                <span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">estimator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_features_to_select</span> <span class="o">=</span> <span class="n">n_features_to_select</span>
<span class="c1">#         self.score_on_set = score_on_set</span>
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform forward feature selection and save selected feature subset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : pd.DataFrame or numpy.ndarray of shape (n_samples, n_features)</span>
<span class="sd">            Feature matrix.</span>
<span class="sd">        y : pd.Series or numpy.ndarray of shape (n_samples,) (default : None)</span>
<span class="sd">            Target values.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : returns an instance of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span>

        <span class="n">feats_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># not yet selected features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_feats_idx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># selected features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_feats_scores</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># scores of the selected features</span>

        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features_to_select</span><span class="p">):</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">feats_idx</span><span class="p">:</span> 
                <span class="c1"># use `self.estimator` to compute score after addition of the feature number `i`</span>
                <span class="c1"># YOUR CODE HERE</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
                <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">))</span>
                
            <span class="c1"># select feature with thte best score</span>
            <span class="n">best_score_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_feats_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">best_score_idx</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_feats_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feats_idx</span><span class="p">[</span><span class="n">best_score_idx</span><span class="p">])</span>
            <span class="n">feats_idx</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">feats_idx</span><span class="p">[</span><span class="n">best_score_idx</span><span class="p">])</span>
       
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features according to precomputed feature subset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : numpy.ndarray of shape (n_samples, n_features)</span>
<span class="sd">            Feature matrix.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X_transformed : array-like of shape (n_samples, n_features)</span>
<span class="sd">            Transformed feature matrix. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
        <span class="c1"># use `self.selected_feats_idx` to select &quot;the best&quot; features</span>
        <span class="c1"># YOUR CODE HERE</span>
        <span class="n">X_transformed</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_feats_idx</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">X_transformed</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-1c220d297c556a99"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-1c220d297c556a99</code></span>
  <span class="pull-right">
      Score: 2.0 / 2.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TEST ForwardFeatureSelection on toy example</span>
<span class="n">test_data_X</span> <span class="o">=</span> <span class="n">X_tr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">:]</span>
<span class="n">test_data_y</span> <span class="o">=</span> <span class="n">y_tr</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">ForwardFeatureSelection</span><span class="p">(</span><span class="n">Ridge</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># fit</span>
<span class="n">selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test_data_X</span><span class="p">,</span> <span class="n">test_data_y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Selected columns:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_data_X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">selector</span><span class="o">.</span><span class="n">selected_feats_idx</span><span class="p">])</span>

<span class="c1"># transform</span>
<span class="n">X_transformed</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data_X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_transformed</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">ForwardFeatureSelection</span><span class="p">(</span><span class="n">Ridge</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test_data_X</span><span class="p">,</span> <span class="n">test_data_y</span><span class="p">)</span>
<span class="n">selected_4</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">selected_feats_idx</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="n">selected_feats_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Wong number of features selected&#39;</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">ForwardFeatureSelection</span><span class="p">(</span><span class="n">Ridge</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test_data_X</span><span class="p">,</span> <span class="n">test_data_y</span><span class="p">)</span>
<span class="n">selected_2</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">selected_feats_idx</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">selected_2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">selected_4</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="s1">&#39;Columns are not selected correctly&#39;</span>

<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Selected columns:
Index([&#39;X384&#39;, &#39;X385&#39;], dtype=&#39;object&#39;)
[[0 0]
 [0 0]
 [0 0]
 [0 0]
 [0 0]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 1.7</strong> [1 pt] <a class="anchor" id="task7"></a></p>
<p>Initialize the model with Forward Feature Selection method.</p>
<p>Create <code>model_forward</code> - Pipeline with three steps:</p>
<ul>
<li><strong>col_transformer</strong> that you've created in task 1.2</li>
<li><strong>feat_selector</strong>  - <code>ForwardFeatureSelection</code> transformer implemented in the previous task. It should use <code>Ridge</code> regression with default parameters as an internal estimator to select <code>20</code> features. </li>
<li><strong>estimator</strong> - <code>Ridge</code> regression with default parameters.</li>
</ul>
<p><em>Note, that instance of Ridge regression used in <code>ForwardFeatureSelection</code> transformer should not be the same used as estimator. You need 2 independent instances of th esame model.</em></p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-5c1a5955756166d7"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">model_forward</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">col_transformer</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;selector&#39;</span><span class="p">,</span> <span class="n">ForwardFeatureSelection</span><span class="p">(</span><span class="n">Ridge</span><span class="p">(),</span> <span class="mi">20</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;estimator&#39;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">()),</span>
<span class="p">])</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-8687020d4055d994"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-8687020d4055d994</code></span>
  <span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TEST model with ForwardFeatureSelection</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pipeline:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="c1"># test model pipeline</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ColumnTransformer</span><span class="p">),</span> <span class="s1">&#39;First step of the pipeline should be columns transformer&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ForwardFeatureSelection</span><span class="p">),</span> <span class="s1">&#39;Second step of the pipeline should be ForwardFeatureSelection&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">),</span> <span class="s1">&#39;RFE should use Ridge as an estimator&#39;</span>
<span class="k">assert</span> <span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n_features_to_select</span> <span class="o">==</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;RFE should select 30 features&#39;</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_forward</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ridge</span><span class="p">),</span> <span class="s1">&#39;Third step of the pipeline should be Ridge regression&#39;</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline:
(&#39;transform&#39;, ColumnTransformer(remainder=&#39;passthrough&#39;,
                  transformers=[(&#39;ohe&#39;, OneHotEncoder(handle_unknown=&#39;ignore&#39;),
                                 [&#39;X0&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;X4&#39;, &#39;X5&#39;, &#39;X6&#39;,
                                  &#39;X8&#39;])]))
(&#39;selector&#39;, ForwardFeatureSelection(estimator=Ridge(), n_features_to_select=20))
(&#39;estimator&#39;, Ridge())
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Evaluate the model (it may take some time).</p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">R2_tr_forward</span><span class="p">,</span> <span class="n">R2_te_forward</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">model_forward</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_tr_forward</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_te_forward</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
Input <span class="ansi-green-fg">In [24]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span> R2_tr_forward, R2_te_forward <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">evaluate_model</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">model_forward</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X_tr</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y_tr</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X_te</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y_te</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Train R2 = </span><span class="ansi-bold" style="color: rgb(175,95,135)">%.2f</span><span style="color: rgb(175,0,0)">&#34;</span> <span style="color: rgb(98,98,98)">%</span> R2_tr_forward)
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Test R2 = </span><span class="ansi-bold" style="color: rgb(175,95,135)">%.2f</span><span style="color: rgb(175,0,0)">&#34;</span> <span style="color: rgb(98,98,98)">%</span> R2_te_forward)

Input <span class="ansi-green-fg">In [6]</span>, in <span class="ansi-cyan-fg">evaluate_model</span><span class="ansi-blue-fg">(model, X_tr, y_tr, X_te, y_te)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>     model<span style="color: rgb(98,98,98)">.</span>set_params(random_state<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">0</span>);    
<span class="ansi-green-intense-fg ansi-bold">     13</span> <span style="color: rgb(95,135,135)"># YOUR CODE HERE</span>
<span class="ansi-green-fg">---&gt; 14</span> <span class="ansi-yellow-bg">model</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X_tr</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y_tr</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> y_pred_tr <span style="color: rgb(98,98,98)">=</span> model<span style="color: rgb(98,98,98)">.</span>predict(X_tr)
<span class="ansi-green-intense-fg ansi-bold">     16</span> y_pred_te <span style="color: rgb(98,98,98)">=</span> model<span style="color: rgb(98,98,98)">.</span>predict(X_te)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/pipeline.py:378</span>, in <span class="ansi-cyan-fg">Pipeline.fit</span><span class="ansi-blue-fg">(self, X, y, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    352</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Fit the model.</span>
<span class="ansi-green-intense-fg ansi-bold">    353</span> 
<span class="ansi-green-intense-fg ansi-bold">    354</span> <span style="color: rgb(175,0,0)">Fit all the transformers one after the other and transform the</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    375</span> <span style="color: rgb(175,0,0)">    Pipeline with fitted steps.</span>
<span class="ansi-green-intense-fg ansi-bold">    376</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    377</span> fit_params_steps <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_check_fit_params(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)
<span class="ansi-green-fg">--&gt; 378</span> Xt <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params_steps</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    379</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _print_elapsed_time(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Pipeline</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_log_message(<span style="color: rgb(0,135,0)">len</span>(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>steps) <span style="color: rgb(98,98,98)">-</span> <span style="color: rgb(98,98,98)">1</span>)):
<span class="ansi-green-intense-fg ansi-bold">    380</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_final_estimator <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">passthrough</span><span style="color: rgb(175,0,0)">&#34;</span>:

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/pipeline.py:336</span>, in <span class="ansi-cyan-fg">Pipeline._fit</span><span class="ansi-blue-fg">(self, X, y, **fit_params_steps)</span>
<span class="ansi-green-intense-fg ansi-bold">    334</span>     cloned_transformer <span style="color: rgb(98,98,98)">=</span> clone(transformer)
<span class="ansi-green-intense-fg ansi-bold">    335</span> <span style="color: rgb(95,135,135)"># Fit or load from cache the current transformer</span>
<span class="ansi-green-fg">--&gt; 336</span> X, fitted_transformer <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">fit_transform_one_cached</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    337</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">cloned_transformer</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    338</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    339</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    340</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">None</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    341</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">message_clsname</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Pipeline</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    342</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">message</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_log_message</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">step_idx</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    343</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params_steps</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    344</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    345</span> <span style="color: rgb(95,135,135)"># Replace the transformer of the step with the fitted</span>
<span class="ansi-green-intense-fg ansi-bold">    346</span> <span style="color: rgb(95,135,135)"># transformer. This is necessary when loading the transformer</span>
<span class="ansi-green-intense-fg ansi-bold">    347</span> <span style="color: rgb(95,135,135)"># from the cache.</span>
<span class="ansi-green-intense-fg ansi-bold">    348</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>steps[step_idx] <span style="color: rgb(98,98,98)">=</span> (name, fitted_transformer)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/memory.py:349</span>, in <span class="ansi-cyan-fg">NotMemorizedFunc.__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    348</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__call__</span>(<span style="color: rgb(0,135,0)">self</span>, <span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg">--&gt; 349</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/pipeline.py:870</span>, in <span class="ansi-cyan-fg">_fit_transform_one</span><span class="ansi-blue-fg">(transformer, X, y, weight, message_clsname, message, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    868</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _print_elapsed_time(message_clsname, message):
<span class="ansi-green-intense-fg ansi-bold">    869</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">hasattr</span>(transformer, <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">fit_transform</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-fg">--&gt; 870</span>         res <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">transformer</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit_transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    871</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    872</span>         res <span style="color: rgb(98,98,98)">=</span> transformer<span style="color: rgb(98,98,98)">.</span>fit(X, y, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)<span style="color: rgb(98,98,98)">.</span>transform(X)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/base.py:870</span>, in <span class="ansi-cyan-fg">TransformerMixin.fit_transform</span><span class="ansi-blue-fg">(self, X, y, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    867</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>fit(X, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)<span style="color: rgb(98,98,98)">.</span>transform(X)
<span class="ansi-green-intense-fg ansi-bold">    868</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    869</span>     <span style="color: rgb(95,135,135)"># fit method of arity 2 (supervised transformation)</span>
<span class="ansi-green-fg">--&gt; 870</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params</span><span class="ansi-yellow-bg">)</span><span style="color: rgb(98,98,98)">.</span>transform(X)

Input <span class="ansi-green-fg">In [20]</span>, in <span class="ansi-cyan-fg">ForwardFeatureSelection.fit</span><span class="ansi-blue-fg">(self, X, y)</span>
<span class="ansi-green-intense-fg ansi-bold">     50</span> scores <span style="color: rgb(98,98,98)">=</span> []
<span class="ansi-green-intense-fg ansi-bold">     51</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> i <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> feats_idx: 
<span class="ansi-green-intense-fg ansi-bold">     52</span>     <span style="color: rgb(95,135,135)"># use `self.estimator` to compute score after addition of the feature number `i`</span>
<span class="ansi-green-intense-fg ansi-bold">     53</span>     <span style="color: rgb(95,135,135)"># YOUR CODE HERE</span>
<span class="ansi-green-fg">---&gt; 54</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">estimator</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">:</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">:</span><span class="ansi-yellow-bg">i</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">+</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     55</span>     scores<span style="color: rgb(98,98,98)">.</span>append(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>estimator<span style="color: rgb(98,98,98)">.</span>score(X[:, :i <span style="color: rgb(98,98,98)">+</span> <span style="color: rgb(98,98,98)">1</span>], y))
<span class="ansi-green-intense-fg ansi-bold">     57</span> <span style="color: rgb(95,135,135)"># select feature with thte best score</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/linear_model/_ridge.py:1130</span>, in <span class="ansi-cyan-fg">Ridge.fit</span><span class="ansi-blue-fg">(self, X, y, sample_weight)</span>
<span class="ansi-green-intense-fg ansi-bold">   1121</span> _accept_sparse <span style="color: rgb(98,98,98)">=</span> _get_valid_accept_sparse(sparse<span style="color: rgb(98,98,98)">.</span>issparse(X), <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>solver)
<span class="ansi-green-intense-fg ansi-bold">   1122</span> X, y <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_validate_data(
<span class="ansi-green-intense-fg ansi-bold">   1123</span>     X,
<span class="ansi-green-intense-fg ansi-bold">   1124</span>     y,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">   1128</span>     y_numeric<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>,
<span class="ansi-green-intense-fg ansi-bold">   1129</span> )
<span class="ansi-green-fg">-&gt; 1130</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">super</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">sample_weight</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">sample_weight</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/linear_model/_ridge.py:889</span>, in <span class="ansi-cyan-fg">_BaseRidge.fit</span><span class="ansi-blue-fg">(self, X, y, sample_weight)</span>
<span class="ansi-green-intense-fg ansi-bold">    885</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    886</span>         <span style="color: rgb(95,135,135)"># for dense matrices or when intercept is set to 0</span>
<span class="ansi-green-intense-fg ansi-bold">    887</span>         params <span style="color: rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg">--&gt; 889</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>coef_, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>n_iter_ <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_ridge_regression</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    890</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    891</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    892</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">alpha</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">alpha</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    893</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">sample_weight</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">sample_weight</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    894</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">max_iter</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">max_iter</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    895</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">tol</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">tol</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    896</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">solver</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">solver</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    897</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">positive</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">positive</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    898</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">random_state</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    899</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">return_n_iter</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    900</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">return_intercept</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">False</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    901</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">check_input</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">False</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    902</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">fit_intercept</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit_intercept</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    903</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">params</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    904</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    905</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_set_intercept(X_offset, y_offset, X_scale)
<span class="ansi-green-intense-fg ansi-bold">    907</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/linear_model/_ridge.py:699</span>, in <span class="ansi-cyan-fg">_ridge_regression</span><span class="ansi-blue-fg">(X, y, alpha, sample_weight, solver, max_iter, tol, verbose, positive, random_state, return_n_iter, return_intercept, X_scale, X_offset, check_input, fit_intercept)</span>
<span class="ansi-green-intense-fg ansi-bold">    697</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    698</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 699</span>         coef <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_solve_cholesky</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">alpha</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    700</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> linalg<span style="color: rgb(98,98,98)">.</span>LinAlgError:
<span class="ansi-green-intense-fg ansi-bold">    701</span>         <span style="color: rgb(95,135,135)"># use SVD solver if matrix is singular</span>
<span class="ansi-green-intense-fg ansi-bold">    702</span>         solver <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">svd</span><span style="color: rgb(175,0,0)">&#34;</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/linear_model/_ridge.py:205</span>, in <span class="ansi-cyan-fg">_solve_cholesky</span><span class="ansi-blue-fg">(X, y, alpha)</span>
<span class="ansi-green-intense-fg ansi-bold">    202</span> n_features <span style="color: rgb(98,98,98)">=</span> X<span style="color: rgb(98,98,98)">.</span>shape[<span style="color: rgb(98,98,98)">1</span>]
<span class="ansi-green-intense-fg ansi-bold">    203</span> n_targets <span style="color: rgb(98,98,98)">=</span> y<span style="color: rgb(98,98,98)">.</span>shape[<span style="color: rgb(98,98,98)">1</span>]
<span class="ansi-green-fg">--&gt; 205</span> A <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">safe_sparse_dot</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">T</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">dense_output</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span> Xy <span style="color: rgb(98,98,98)">=</span> safe_sparse_dot(X<span style="color: rgb(98,98,98)">.</span>T, y, dense_output<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>)
<span class="ansi-green-intense-fg ansi-bold">    208</span> one_alpha <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>array_equal(alpha, <span style="color: rgb(0,135,0)">len</span>(alpha) <span style="color: rgb(98,98,98)">*</span> [alpha[<span style="color: rgb(98,98,98)">0</span>]])

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/utils/extmath.py:152</span>, in <span class="ansi-cyan-fg">safe_sparse_dot</span><span class="ansi-blue-fg">(a, b, dense_output)</span>
<span class="ansi-green-intense-fg ansi-bold">    150</span>         ret <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>dot(a, b)
<span class="ansi-green-intense-fg ansi-bold">    151</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 152</span>     ret <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">a</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">@</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">b</span>
<span class="ansi-green-intense-fg ansi-bold">    154</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> (
<span class="ansi-green-intense-fg ansi-bold">    155</span>     sparse<span style="color: rgb(98,98,98)">.</span>issparse(a)
<span class="ansi-green-intense-fg ansi-bold">    156</span>     <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> sparse<span style="color: rgb(98,98,98)">.</span>issparse(b)
<span class="ansi-green-intense-fg ansi-bold">    157</span>     <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> dense_output
<span class="ansi-green-intense-fg ansi-bold">    158</span>     <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">hasattr</span>(ret, <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">toarray</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">    159</span> ):
<span class="ansi-green-intense-fg ansi-bold">    160</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> ret<span style="color: rgb(98,98,98)">.</span>toarray()

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Let us see, how the performance of the model was changing.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">R2_tr</span><span class="p">,</span> <span class="n">R2_tr_kbest</span><span class="p">,</span> <span class="n">R2_tr_rfe</span><span class="p">,</span> <span class="n">R2_tr_forward</span><span class="p">]</span>
<span class="n">test_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">R2_te</span> <span class="p">,</span><span class="n">R2_te_kbest</span><span class="p">,</span> <span class="n">R2_te_rfe</span><span class="p">,</span> <span class="n">R2_te_forward</span><span class="p">]</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;All features&#39;</span><span class="p">,</span> <span class="s1">&#39;KBest&#39;</span><span class="p">,</span> <span class="s1">&#39;RFE&#39;</span><span class="p">,</span> <span class="s1">&#39;Forward Selection&#39;</span><span class="p">]</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_scores</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_scores</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)),</span> <span class="n">train_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)),</span> <span class="n">test_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)),</span> <span class="n">models</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Model&#39;s R2 score&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Dependence of model&#39;s score on the features selection method&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [25]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span> train_scores <span style="color: rgb(98,98,98)">=</span> [R2_tr, R2_tr_kbest, R2_tr_rfe, <span class="ansi-yellow-bg">R2_tr_forward</span>]
<span class="ansi-green-intense-fg ansi-bold">      2</span> test_scores <span style="color: rgb(98,98,98)">=</span> [R2_te ,R2_te_kbest, R2_te_rfe, R2_te_forward]
<span class="ansi-green-intense-fg ansi-bold">      3</span> models <span style="color: rgb(98,98,98)">=</span> [<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">All features</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">KBest</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">RFE</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Forward Selection</span><span style="color: rgb(175,0,0)">&#39;</span>]

<span class="ansi-red-fg">NameError</span>: name &#39;R2_tr_forward&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<h2 id="Problem-2.-Model-hyperparameter-tuning--">Problem 2. Model hyperparameter tuning  <a class="anchor" id="part2" /><a class="anchor-link" href="#Problem-2.-Model-hyperparameter-tuning--">&#182;</a></h2><hr>
<p>In the previous task, we used Ridge regression with $l_2$ regularization to predict the target variable. The model hyperparameter <code>alpha</code> determines the strength of the regularization, but so far we have used its default value ($alpha = 1$), which may be not optimal.</p>
<p>In addition, different models may require different degrees of regularization, and it would be incorrect to compare their quality with one fixed value. Now we will optimize the degree of regularization of our regression model.</p>
<!-- Among `sklearn.linear_models`, you can find implementation of the regression models with $l_1$ regularization (`Lasso`), $l_2$ regularization (`Ridge`), as well as their combination (`ElasticNet`). -->

<p><strong>Grid search</strong> is commonly used to find the optimal value of the regularization coefficient (and other model hyperparameters). For each combination of hyperparameters, a model is trained, and its performance is measured on a validation set or using cross-validation. The set of hyperparameters at which the model achieves the best validation performance is optimal.</p>
<p>Note that the test set on which the final model evaluation is performed should not be used as a validation set for hyperparameter tuning. Otherwise, overfitting occurs and the model quality measured on this test set no longer reflects its predictive ability for the new unseen data.</p>
<p><code>Sklearn</code> has ready-to-use implementation of grid search - <code>GridSearchCV</code> estimator.  It evaluates model performance on cross-validation for each hyperparameter set and selects the best model accordingly.</p>

    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 2.1</strong> [1 pt] <a class="anchor" id="task2_1"></a></p>
<p>Use <code>GridSearchCV</code> to find optimal $l_2$ regularization coefficient for two models:</p>
<ol>
<li>Baseline pipeline without feature selection (<code>model</code> from task 1.2)</li>
<li>Pipeline with univariate feature selection (<code>model_k_best</code> from task 1.4).</li>
</ol>
<p>Then, compare which model is better with optimal hyperparameters.</p>
<ul>
<li><p>We will use <code>alphas</code> - list of regularization coefficient (<code>estimator__alpha</code>) to search through.</p>
</li>
<li><p>Create two <code>GridSearchCV</code> objects</p>
<ul>
<li><code>grid_cv</code> for baseline model </li>
<li><code>grid_cv_k_best</code> for model with feature selection. </li>
</ul>
</li>
<li><p>For each model, fit <code>GridSearchCV</code> on the whole training set <code>X_tr</code>. Optimize $R^2$-score on 3-fold cross-validation.</p>
</li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-a2c6dc9a02792447"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;estimator__alpha&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="n">grid_cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> 
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> 
    <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>

<span class="n">grid_cv_k_best</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> 
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> 
    <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>

<span class="n">grid_cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">),</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">)</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(GridSearchCV(cv=3,
              estimator=Pipeline(steps=[(&#39;transform&#39;,
                                         ColumnTransformer(remainder=&#39;passthrough&#39;,
                                                           transformers=[(&#39;ohe&#39;,
                                                                          OneHotEncoder(handle_unknown=&#39;ignore&#39;),
                                                                          [&#39;X0&#39;,
                                                                           &#39;X1&#39;,
                                                                           &#39;X2&#39;,
                                                                           &#39;X3&#39;,
                                                                           &#39;X4&#39;,
                                                                           &#39;X5&#39;,
                                                                           &#39;X6&#39;,
                                                                           &#39;X8&#39;])])),
                                        (&#39;estimator&#39;, Ridge(random_state=0))]),
              param_grid={&#39;estimator__alpha&#39;: array([1.e-04, 1.e-03, 1.e-02, 1.e-01, 1.e+00, 1.e+01, 1.e+02, 1.e+03,
        1.e+04])},
              scoring=&#39;r2&#39;),
 GridSearchCV(cv=3,
              estimator=Pipeline(steps=[(&#39;transform&#39;,
                                         ColumnTransformer(remainder=&#39;passthrough&#39;,
                                                           transformers=[(&#39;ohe&#39;,
                                                                          OneHotEncoder(handle_unknown=&#39;ignore&#39;),
                                                                          [&#39;X0&#39;,
                                                                           &#39;X1&#39;,
                                                                           &#39;X2&#39;,
                                                                           &#39;X3&#39;,
                                                                           &#39;X4&#39;,
                                                                           &#39;X5&#39;,
                                                                           &#39;X6&#39;,
                                                                           &#39;X8&#39;])])),
                                        (&#39;estimator&#39;, Ridge(random_state=0))]),
              param_grid={&#39;estimator__alpha&#39;: array([1.e-04, 1.e-03, 1.e-02, 1.e-01, 1.e+00, 1.e+01, 1.e+02, 1.e+03,
        1.e+04])},
              scoring=&#39;r2&#39;))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-6614804c811b77b5"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-6614804c811b77b5</code></span>
  <span class="pull-right">
      Score: 0.0 / 1.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TEST grid_cv model</span>
<span class="k">assert</span> <span class="s2">&quot;estimator__alpha&quot;</span> <span class="ow">in</span> <span class="n">grid_cv</span><span class="o">.</span><span class="n">param_grid</span>
<span class="k">assert</span> <span class="s2">&quot;estimator__alpha&quot;</span> <span class="ow">in</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">param_grid</span>
<span class="k">assert</span> <span class="n">grid_cv</span><span class="o">.</span><span class="n">scoring</span> <span class="o">==</span> <span class="s1">&#39;r2&#39;</span>
<span class="k">assert</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">scoring</span> <span class="o">==</span> <span class="s1">&#39;r2&#39;</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">grid_cv</span><span class="o">.</span><span class="n">param_grid</span><span class="p">[</span><span class="s2">&quot;estimator__alpha&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">grid_cv</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ColumnTransformer</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ridge</span><span class="p">)</span>

<span class="n">best_k</span> <span class="o">=</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_k</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ColumnTransformer</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_k</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">SelectKBest</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_k</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ridge</span><span class="p">)</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
Input <span class="ansi-green-fg">In [27]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 15&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span> best_k <span style="color: rgb(98,98,98)">=</span> grid_cv_k_best<span style="color: rgb(98,98,98)">.</span>best_estimator_
<span class="ansi-green-intense-fg ansi-bold">     14</span> <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> <span style="color: rgb(0,135,0)">isinstance</span>(best_k<span style="color: rgb(98,98,98)">.</span>steps[<span style="color: rgb(98,98,98)">0</span>][<span style="color: rgb(98,98,98)">1</span>], ColumnTransformer)
<span class="ansi-green-fg">---&gt; 15</span> <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> <span style="color: rgb(0,135,0)">isinstance</span>(best_k<span style="color: rgb(98,98,98)">.</span>steps[<span style="color: rgb(98,98,98)">1</span>][<span style="color: rgb(98,98,98)">1</span>], SelectKBest)
<span class="ansi-green-intense-fg ansi-bold">     16</span> <span class="ansi-bold" style="color: rgb(0,135,0)">assert</span> <span style="color: rgb(0,135,0)">isinstance</span>(best_k<span style="color: rgb(98,98,98)">.</span>steps[<span style="color: rgb(98,98,98)">2</span>][<span style="color: rgb(98,98,98)">1</span>], Ridge)

<span class="ansi-red-fg">AssertionError</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <ul>
<li>Plot the dependence of the models' validation performances on the alpha value and visually compare how the quality of each model depends on the regularization degree.</li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">grid_cv</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;without feature selection&quot;</span><span class="p">)</span>
<span class="n">scores_k_best</span> <span class="o">=</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">scores_k_best</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;with feature selection&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CV score&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Without feature selection:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal alpha  = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">grid_cv</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;estimator__alpha&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal R2 score = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">grid_cv</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;With feature selection:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal alpha  = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;estimator__alpha&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal R2 score = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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r75aVJ6SksI111xTLftISUlhyZIlpa7LyclhxIgRxMXFMXPmzEpve/bs2Wza5BvzKCYnJ7N69epKt1u7di1z5/4wZdicOXN45plnqjM0Yy5ZSKdB1JGzpK+tuem/LUG4bO7cuTRq1OiCBFGdyksQa9asAQq/JG+55ZZKb7sqCSIvL6/S+3FSyQQxZswYJk+e7GJExlwoMuFKAI6nptTYPi1BOOjZZ5/l5ZdfBuChhx5i2LBhACxYsIDbb78dgMjISA4fPszkyZNJS0sjLi6ORx99FCh8vOGdd95Jt27duP3221FVAObPn098fDw9e/bkrrvuIicn57xtAaxcuZLk5GR27NjB66+/zgsvvEBcXByLFi0qiu/gwYPccccdrFixgri4ONLS0li1ahVDhgyhd+/ejBo1in379gHw97//naSkJGJjY7nxxhvJyspiyZIlzJkzh0cffbSofXJyMitXrgTg8OHDREZGAjBt2jTGjBnDsGHDGD58OKdPn+auu+6iT58+xMfH89FHH13Qf/v27WPw4MHExcXRo0ePotjnzZtH//79SUhI4OabbyYzM/OCtmXVWbFiBQMGDCA2NpY+ffpw4sQJnnjiCWbOnFl0FDVt2jTuu+8+AHbs2MGwYcPo1asXw4cPZ9euXQCMHz+eSZMmMWDAADp06MCsWbMq/wNiTCU0btaSHZ521K3BcQi/vsy1uP/+v41s2nuyWrcZ3aoBT14bU+b6QYMG8de//pVJkyaxcuVKcnJyyM3NZdGiRQwePPi8us888wwbNmxg7dq1QOFf/WvWrGH58uV06dKFgQMHsnjxYhITExk/fjzz58+nS5cu/PSnP+W1117jwQcfLDWGyMhIJk6cSL169XjkkUfOW9e8eXPefPNNnnvuOT7++GNyc3O58847+eijj2jWrBkzZ87kscceY+rUqdxwww3cfffdADz++OO89dZb3H///YwZM4ZrrrmGm2666aL9tXr1atatW0d4eDi/+93vGDZsGFOnTuX48eP06dOHESNGEBb2wzXe77zzDqNGjeKxxx4jPz+frKwsDh8+zNNPP82XX35JWFgYf/7zn3n++ed54omiWeTLrDN58mRuueUWZs6cSVJSEidPnqRu3bo89dRTrFy5kv/93/8FCpPZOffffz/jxo1j3LhxTJ06lUmTJjF79mygMIF98803bN68mTFjxlSoD4y5FAfCE+l56BNyz+YQFBzi+P4umwThht69e7Nq1SpOnjxJSEgICQkJrFy5kkWLFhUdWZSnT58+tG7dGo/HQ1xcHDt27KB+/fpERUXRpUsXAMaNG8eUKVPKTBCVsWXLFjZs2MDIkSMByM/Pp2XLlgBs2LCBxx9/nOPHj5OZmcmoUaMqvf2RI0cSHh4OFP6FP2fOHJ577jmg8JLkXbt20b1796L6SUlJ3HXXXeTm5vLjH/+YuLg4vvrqKzZt2sTAgQMBOHv2LP379z9vP8uWLSu1zpYtW2jZsiVJSUkANGjQ4KIxL126lA8++ACAO++8k1//+tdF63784x/j8XiIjo7mwIEDle4PYyorsMNg6h7+gC3rFtM1cZjz+3N8Dz6ivL/0nRIUFERUVBTTpk1jwIAB9OrVi4ULF7Jt27bzvgjLEhLyw18IAQEBFz13HxgYSEFBAUCVrr9XVWJiYli6dOkF68aPH8/s2bOJjY1l2rRppKSkVDqG4kcHqsr7779P165dy4xn8ODBfP3113zyySeMHz+ehx9+mMaNGzNy5Ej+85//lPs5Squzfv36MttURfH/n3On/4xxUvuEEfAtHNu0EGogQdgYhMMGDRrEc889x+DBgxk0aBCvv/468fHxF1wjX79+fU6duvh0vl27dmXHjh1s27YNgH/9618MGTIEKDydtGrVKgDef//9Km370KFDRQkiNzeXjRs3AoV3KLds2ZLc3FymT59e5raLx1DeeflRo0bxyiuvFH2xnhssL27nzp1ERERw991384tf/ILVq1fTr18/Fi9eXPT5T58+zffff39eu7LqdO3alX379rFixYqiz5SXl1du/wwYMIAZM2YAMH36dAYNGlTmZzLGaU1btGWnpw119tXMOIQlCIcNGjSIffv20b9/fyIiIggNDS31S6ZJkyYMHDiQHj16FA1SlyY0NJS3336bm2++mZ49e+LxeJg4cSIATz75JA888ACJiYkEBAQUtbn22mv58MMPLxikLik4OJhZs2bxm9/8htjYWOLi4oqufvrDH/5A3759GThwIN26dStqc+utt/Lss88SHx9PWloajzzyCK+99hrx8fFFA+al+f3vf09ubi69evUiJiaG3//+9xfUSUlJITY2lvj4eGbOnMkDDzxAs2bNmDZtGrfddhu9evWif//+bN68+bx2ZdUJDg5m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
"
>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Without feature selection:
Optimal alpha  = 100.0000
Optimal R2 score = 0.5273

With feature selection:
Optimal alpha  = 100.0000
Optimal R2 score = 0.5273
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <ul>
<li>Select the better model, fix the optimal value of the regularization coefficient, fit it on the training set, and estimate its performance on the test set <code>X_te</code>. </li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">R2_tr</span><span class="p">,</span> <span class="n">R2_te</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_tr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_te</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train R2 = 0.57
Test R2 = 0.59
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <p>Also, we can perform the search of optimal number of selected features <code>k</code>. However, the optimal strength of regularization will also depend on the number of selected features, since models with larger number of features usually need stronger regularization. Thus, it is a good idea to perform grid search for two these parameters simultaneously.</p>
<!-- Also, we can still assume that some of the features generated by the one-hot encoding of categorical variables are redundant. In this case, you may want to use a $l_1$ -regularization, which is more likely to assign exactly zero weights to insignificant variables. Thus, an internal feature selection by importance is performed, and the final model depends on a smaller number of variables.

Among `sklearn.linear_models`, you can find implementation of the regression models with $l_1$ regularization (`Lasso`), $l_2$ regularization (`Ridge`), as well as their combination (`ElasticNet`). -->
    </div>
  </div></div>

<div class="cell border-box-sizing text_cell rendered">
  <div class="prompt input_prompt">
</div><div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
      <hr>
<p><strong>Task 2.2</strong> [1pt] <a class="anchor" id="task2_2"></a></p>
<p>Perform grid search for 2 hyperparameters to find both optimal <strong>regularization coefficient</strong> value (<code>alpha</code>) and <strong>number of features</strong> ($k$) for the pipeline with univariate feature selection (<code>model_k_best</code> from task 1.4).</p>
<p>Blow we define:</p>
<ul>
<li><code>alphas</code> - list of regularization coefficient to search through. </li>
<li><code>ks</code> - list of number of features values to search through.</li>
</ul>
<p>Your task:</p>
<ul>
<li><p>Create <code>grid_cv_k_best</code></p>
<ul>
<li><code>GridSearchCV</code> object</li>
<li>Use <code>alphas</code> and <code>ks</code> to define parameter grid for estimator and feature selector</li>
</ul>
</li>
<li><p>Fit <code>grid_cv_k_best</code> on the whole training set <code>X_tr</code>. Optimize $R^2$-score on 3-fold cross-validation.</p>
</li>
</ul>

    </div>
  </div></div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="comment-cell-dc307258540ac640"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_k_best</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">estimator__random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">ks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;estimator__alpha&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span>
    <span class="s2">&quot;selector__k&quot;</span> <span class="p">:</span> <span class="n">ks</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="n">grid_cv_k_best</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">model_k_best</span><span class="p">,</span> 
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> 
    <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>

<span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">)</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
Input <span class="ansi-green-fg">In [30]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 17&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> <span style="color: rgb(95,135,135)"># YOUR CODE HERE</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span> grid_cv_k_best <span style="color: rgb(98,98,98)">=</span> GridSearchCV(
<span class="ansi-green-intense-fg ansi-bold">     12</span>     model_k_best, 
<span class="ansi-green-intense-fg ansi-bold">     13</span>     param_grid<span style="color: rgb(98,98,98)">=</span>param_grid, 
<span class="ansi-green-intense-fg ansi-bold">     14</span>     cv<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">3</span>, 
<span class="ansi-green-intense-fg ansi-bold">     15</span>     scoring<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">r2</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">---&gt; 17</span> <span class="ansi-yellow-bg">grid_cv_k_best</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X_tr</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y_tr</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/model_selection/_search.py:875</span>, in <span class="ansi-cyan-fg">BaseSearchCV.fit</span><span class="ansi-blue-fg">(self, X, y, groups, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    869</span>     results <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_format_results(
<span class="ansi-green-intense-fg ansi-bold">    870</span>         all_candidate_params, n_splits, all_out, all_more_results
<span class="ansi-green-intense-fg ansi-bold">    871</span>     )
<span class="ansi-green-intense-fg ansi-bold">    873</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> results
<span class="ansi-green-fg">--&gt; 875</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_run_search</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">evaluate_candidates</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    877</span> <span style="color: rgb(95,135,135)"># multimetric is determined here because in the case of a callable</span>
<span class="ansi-green-intense-fg ansi-bold">    878</span> <span style="color: rgb(95,135,135)"># self.scoring the return type is only known after calling</span>
<span class="ansi-green-intense-fg ansi-bold">    879</span> first_test_score <span style="color: rgb(98,98,98)">=</span> all_out[<span style="color: rgb(98,98,98)">0</span>][<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">test_scores</span><span style="color: rgb(175,0,0)">&#34;</span>]

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/model_selection/_search.py:1379</span>, in <span class="ansi-cyan-fg">GridSearchCV._run_search</span><span class="ansi-blue-fg">(self, evaluate_candidates)</span>
<span class="ansi-green-intense-fg ansi-bold">   1377</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_run_search</span>(<span style="color: rgb(0,135,0)">self</span>, evaluate_candidates):
<span class="ansi-green-intense-fg ansi-bold">   1378</span>     <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Search all candidates in param_grid&#34;&#34;&#34;</span>
<span class="ansi-green-fg">-&gt; 1379</span>     <span class="ansi-yellow-bg">evaluate_candidates</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">ParameterGrid</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">param_grid</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/model_selection/_search.py:822</span>, in <span class="ansi-cyan-fg">BaseSearchCV.fit.&lt;locals&gt;.evaluate_candidates</span><span class="ansi-blue-fg">(candidate_params, cv, more_results)</span>
<span class="ansi-green-intense-fg ansi-bold">    814</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>verbose <span style="color: rgb(98,98,98)">&gt;</span> <span style="color: rgb(98,98,98)">0</span>:
<span class="ansi-green-intense-fg ansi-bold">    815</span>     <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    816</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Fitting </span><span class="ansi-bold" style="color: rgb(175,95,135)">{0}</span><span style="color: rgb(175,0,0)"> folds for each of </span><span class="ansi-bold" style="color: rgb(175,95,135)">{1}</span><span style="color: rgb(175,0,0)"> candidates,</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    817</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)"> totalling </span><span class="ansi-bold" style="color: rgb(175,95,135)">{2}</span><span style="color: rgb(175,0,0)"> fits</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(98,98,98)">.</span>format(
<span class="ansi-green-intense-fg ansi-bold">    818</span>             n_splits, n_candidates, n_candidates <span style="color: rgb(98,98,98)">*</span> n_splits
<span class="ansi-green-intense-fg ansi-bold">    819</span>         )
<span class="ansi-green-intense-fg ansi-bold">    820</span>     )
<span class="ansi-green-fg">--&gt; 822</span> out <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">parallel</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    823</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">delayed</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">_fit_and_score</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    824</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">clone</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">base_estimator</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    825</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    826</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    827</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    828</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">test</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">test</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    829</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">parameters</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">parameters</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    830</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">split_progress</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">split_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">n_splits</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    831</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">candidate_progress</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">cand_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">n_candidates</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    832</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_and_score_kwargs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    833</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    834</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">for</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">cand_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">parameters</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">split_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">test</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(175,0,255)">in</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">product</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    835</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">enumerate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">candidate_params</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">enumerate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">cv</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">split</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">groups</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    836</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    837</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    839</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">len</span>(out) <span style="color: rgb(98,98,98)">&lt;</span> <span style="color: rgb(98,98,98)">1</span>:
<span class="ansi-green-intense-fg ansi-bold">    840</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(
<span class="ansi-green-intense-fg ansi-bold">    841</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">No fits were performed. </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    842</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Was the CV iterator empty? </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    843</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Were there no candidates?</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    844</span>     )

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/parallel.py:1088</span>, in <span class="ansi-cyan-fg">Parallel.__call__</span><span class="ansi-blue-fg">(self, iterable)</span>
<span class="ansi-green-intense-fg ansi-bold">   1085</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>dispatch_one_batch(iterator):
<span class="ansi-green-intense-fg ansi-bold">   1086</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_iterating <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_original_iterator <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-fg">-&gt; 1088</span> <span class="ansi-bold" style="color: rgb(0,135,0)">while</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">dispatch_one_batch</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">iterator</span><span class="ansi-yellow-bg">)</span>:
<span class="ansi-green-intense-fg ansi-bold">   1089</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">pass</span>
<span class="ansi-green-intense-fg ansi-bold">   1091</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> pre_dispatch <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">all</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> n_jobs <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(98,98,98)">1</span>:
<span class="ansi-green-intense-fg ansi-bold">   1092</span>     <span style="color: rgb(95,135,135)"># The iterable was consumed all at once by the above for loop.</span>
<span class="ansi-green-intense-fg ansi-bold">   1093</span>     <span style="color: rgb(95,135,135)"># No need to wait for async callbacks to trigger to</span>
<span class="ansi-green-intense-fg ansi-bold">   1094</span>     <span style="color: rgb(95,135,135)"># consumption.</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/parallel.py:901</span>, in <span class="ansi-cyan-fg">Parallel.dispatch_one_batch</span><span class="ansi-blue-fg">(self, iterator)</span>
<span class="ansi-green-intense-fg ansi-bold">    899</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>
<span class="ansi-green-intense-fg ansi-bold">    900</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 901</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_dispatch</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">tasks</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    902</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/parallel.py:819</span>, in <span class="ansi-cyan-fg">Parallel._dispatch</span><span class="ansi-blue-fg">(self, batch)</span>
<span class="ansi-green-intense-fg ansi-bold">    817</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_lock:
<span class="ansi-green-intense-fg ansi-bold">    818</span>     job_idx <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">len</span>(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_jobs)
<span class="ansi-green-fg">--&gt; 819</span>     job <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_backend</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">apply_async</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">batch</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">cb</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    820</span>     <span style="color: rgb(95,135,135)"># A job can complete so quickly than its callback is</span>
<span class="ansi-green-intense-fg ansi-bold">    821</span>     <span style="color: rgb(95,135,135)"># called before we get here, causing self._jobs to</span>
<span class="ansi-green-intense-fg ansi-bold">    822</span>     <span style="color: rgb(95,135,135)"># grow. To ensure correct results ordering, .insert is</span>
<span class="ansi-green-intense-fg ansi-bold">    823</span>     <span style="color: rgb(95,135,135)"># used (rather than .append) in the following line</span>
<span class="ansi-green-intense-fg ansi-bold">    824</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_jobs<span style="color: rgb(98,98,98)">.</span>insert(job_idx, job)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/_parallel_backends.py:208</span>, in <span class="ansi-cyan-fg">SequentialBackend.apply_async</span><span class="ansi-blue-fg">(self, func, callback)</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">apply_async</span>(<span style="color: rgb(0,135,0)">self</span>, func, callback<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>):
<span class="ansi-green-intense-fg ansi-bold">    207</span>     <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Schedule a func to be run&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 208</span>     result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">ImmediateResult</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    209</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> callback:
<span class="ansi-green-intense-fg ansi-bold">    210</span>         callback(result)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/_parallel_backends.py:597</span>, in <span class="ansi-cyan-fg">ImmediateResult.__init__</span><span class="ansi-blue-fg">(self, batch)</span>
<span class="ansi-green-intense-fg ansi-bold">    594</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, batch):
<span class="ansi-green-intense-fg ansi-bold">    595</span>     <span style="color: rgb(95,135,135)"># Don&#39;t delay the application, to avoid keeping the input</span>
<span class="ansi-green-intense-fg ansi-bold">    596</span>     <span style="color: rgb(95,135,135)"># arguments in memory</span>
<span class="ansi-green-fg">--&gt; 597</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>results <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">batch</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/parallel.py:288</span>, in <span class="ansi-cyan-fg">BatchedCalls.__call__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    284</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__call__</span>(<span style="color: rgb(0,135,0)">self</span>):
<span class="ansi-green-intense-fg ansi-bold">    285</span>     <span style="color: rgb(95,135,135)"># Set the default nested backend to self._backend but do not set the</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>     <span style="color: rgb(95,135,135)"># change the default number of processes to -1</span>
<span class="ansi-green-intense-fg ansi-bold">    287</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> parallel_backend(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backend, n_jobs<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_n_jobs):
<span class="ansi-green-fg">--&gt; 288</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> [func(<span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)
<span class="ansi-green-intense-fg ansi-bold">    289</span>                 <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> func, args, kwargs <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>items]

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/parallel.py:288</span>, in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    284</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__call__</span>(<span style="color: rgb(0,135,0)">self</span>):
<span class="ansi-green-intense-fg ansi-bold">    285</span>     <span style="color: rgb(95,135,135)"># Set the default nested backend to self._backend but do not set the</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>     <span style="color: rgb(95,135,135)"># change the default number of processes to -1</span>
<span class="ansi-green-intense-fg ansi-bold">    287</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> parallel_backend(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backend, n_jobs<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_n_jobs):
<span class="ansi-green-fg">--&gt; 288</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> [<span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span>                 <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> func, args, kwargs <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>items]

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/utils/fixes.py:117</span>, in <span class="ansi-cyan-fg">_FuncWrapper.__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__call__</span>(<span style="color: rgb(0,135,0)">self</span>, <span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-intense-fg ansi-bold">    116</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> config_context(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>config):
<span class="ansi-green-fg">--&gt; 117</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">function</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:686</span>, in <span class="ansi-cyan-fg">_fit_and_score</span><span class="ansi-blue-fg">(estimator, X, y, scorer, train, test, verbose, parameters, fit_params, return_train_score, return_parameters, return_n_test_samples, return_times, return_estimator, split_progress, candidate_progress, error_score)</span>
<span class="ansi-green-intense-fg ansi-bold">    684</span>         estimator<span style="color: rgb(98,98,98)">.</span>fit(X_train, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)
<span class="ansi-green-intense-fg ansi-bold">    685</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 686</span>         <span class="ansi-yellow-bg">estimator</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X_train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y_train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    688</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span>:
<span class="ansi-green-intense-fg ansi-bold">    689</span>     <span style="color: rgb(95,135,135)"># Note fit time as time until error</span>
<span class="ansi-green-intense-fg ansi-bold">    690</span>     fit_time <span style="color: rgb(98,98,98)">=</span> time<span style="color: rgb(98,98,98)">.</span>time() <span style="color: rgb(98,98,98)">-</span> start_time

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/pipeline.py:378</span>, in <span class="ansi-cyan-fg">Pipeline.fit</span><span class="ansi-blue-fg">(self, X, y, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    352</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Fit the model.</span>
<span class="ansi-green-intense-fg ansi-bold">    353</span> 
<span class="ansi-green-intense-fg ansi-bold">    354</span> <span style="color: rgb(175,0,0)">Fit all the transformers one after the other and transform the</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    375</span> <span style="color: rgb(175,0,0)">    Pipeline with fitted steps.</span>
<span class="ansi-green-intense-fg ansi-bold">    376</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    377</span> fit_params_steps <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_check_fit_params(<span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)
<span class="ansi-green-fg">--&gt; 378</span> Xt <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params_steps</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    379</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _print_elapsed_time(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Pipeline</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_log_message(<span style="color: rgb(0,135,0)">len</span>(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>steps) <span style="color: rgb(98,98,98)">-</span> <span style="color: rgb(98,98,98)">1</span>)):
<span class="ansi-green-intense-fg ansi-bold">    380</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_final_estimator <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">passthrough</span><span style="color: rgb(175,0,0)">&#34;</span>:

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/pipeline.py:336</span>, in <span class="ansi-cyan-fg">Pipeline._fit</span><span class="ansi-blue-fg">(self, X, y, **fit_params_steps)</span>
<span class="ansi-green-intense-fg ansi-bold">    334</span>     cloned_transformer <span style="color: rgb(98,98,98)">=</span> clone(transformer)
<span class="ansi-green-intense-fg ansi-bold">    335</span> <span style="color: rgb(95,135,135)"># Fit or load from cache the current transformer</span>
<span class="ansi-green-fg">--&gt; 336</span> X, fitted_transformer <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">fit_transform_one_cached</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    337</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">cloned_transformer</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    338</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    339</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    340</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">None</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    341</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">message_clsname</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Pipeline</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    342</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">message</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_log_message</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">step_idx</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    343</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params_steps</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    344</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    345</span> <span style="color: rgb(95,135,135)"># Replace the transformer of the step with the fitted</span>
<span class="ansi-green-intense-fg ansi-bold">    346</span> <span style="color: rgb(95,135,135)"># transformer. This is necessary when loading the transformer</span>
<span class="ansi-green-intense-fg ansi-bold">    347</span> <span style="color: rgb(95,135,135)"># from the cache.</span>
<span class="ansi-green-intense-fg ansi-bold">    348</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>steps[step_idx] <span style="color: rgb(98,98,98)">=</span> (name, fitted_transformer)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/joblib/memory.py:349</span>, in <span class="ansi-cyan-fg">NotMemorizedFunc.__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    348</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__call__</span>(<span style="color: rgb(0,135,0)">self</span>, <span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg">--&gt; 349</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/pipeline.py:870</span>, in <span class="ansi-cyan-fg">_fit_transform_one</span><span class="ansi-blue-fg">(transformer, X, y, weight, message_clsname, message, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    868</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _print_elapsed_time(message_clsname, message):
<span class="ansi-green-intense-fg ansi-bold">    869</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">hasattr</span>(transformer, <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">fit_transform</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-fg">--&gt; 870</span>         res <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">transformer</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit_transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    871</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    872</span>         res <span style="color: rgb(98,98,98)">=</span> transformer<span style="color: rgb(98,98,98)">.</span>fit(X, y, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)<span style="color: rgb(98,98,98)">.</span>transform(X)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/base.py:870</span>, in <span class="ansi-cyan-fg">TransformerMixin.fit_transform</span><span class="ansi-blue-fg">(self, X, y, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    867</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>fit(X, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)<span style="color: rgb(98,98,98)">.</span>transform(X)
<span class="ansi-green-intense-fg ansi-bold">    868</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    869</span>     <span style="color: rgb(95,135,135)"># fit method of arity 2 (supervised transformation)</span>
<span class="ansi-green-fg">--&gt; 870</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params</span><span class="ansi-yellow-bg">)</span><span style="color: rgb(98,98,98)">.</span>transform(X)

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/sklearn/feature_selection/_univariate_selection.py:472</span>, in <span class="ansi-cyan-fg">_BaseFilter.fit</span><span class="ansi-blue-fg">(self, X, y)</span>
<span class="ansi-green-intense-fg ansi-bold">    466</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">TypeError</span>(
<span class="ansi-green-intense-fg ansi-bold">    467</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">The score function should be a callable, </span><span class="ansi-bold" style="color: rgb(175,95,135)">%s</span><span style="color: rgb(175,0,0)"> (</span><span class="ansi-bold" style="color: rgb(175,95,135)">%s</span><span style="color: rgb(175,0,0)">) was passed.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    468</span>         <span style="color: rgb(98,98,98)">%</span> (<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>score_func, <span style="color: rgb(0,135,0)">type</span>(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>score_func))
<span class="ansi-green-intense-fg ansi-bold">    469</span>     )
<span class="ansi-green-intense-fg ansi-bold">    471</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_check_params(X, y)
<span class="ansi-green-fg">--&gt; 472</span> score_func_ret <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">score_func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    473</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(score_func_ret, (<span style="color: rgb(0,135,0)">list</span>, <span style="color: rgb(0,135,0)">tuple</span>)):
<span class="ansi-green-intense-fg ansi-bold">    474</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>scores_, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>pvalues_ <span style="color: rgb(98,98,98)">=</span> score_func_ret

Input <span class="ansi-green-fg">In [12]</span>, in <span class="ansi-cyan-fg">get_abs_corr_coef</span><span class="ansi-blue-fg">(X, y)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(175,0,0)">Compute</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> <span style="color: rgb(175,0,0)">    for all features</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     18</span> <span style="color: rgb(95,135,135)"># YOUR CODE HERE</span>
<span class="ansi-green-fg">---&gt; 19</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> np<span style="color: rgb(98,98,98)">.</span>array([np<span style="color: rgb(98,98,98)">.</span>corrcoef(col, y)[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">1</span>] <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> col <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> X<span style="color: rgb(98,98,98)">.</span>T])

Input <span class="ansi-green-fg">In [12]</span>, in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(175,0,0)">Compute</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> <span style="color: rgb(175,0,0)">    for all features</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     18</span> <span style="color: rgb(95,135,135)"># YOUR CODE HERE</span>
<span class="ansi-green-fg">---&gt; 19</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> np<span style="color: rgb(98,98,98)">.</span>array([<span class="ansi-yellow-bg">np</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">corrcoef</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">)</span>[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">1</span>] <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> col <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> X<span style="color: rgb(98,98,98)">.</span>T])

File <span class="ansi-green-fg">&lt;__array_function__ internals&gt;:180</span>, in <span class="ansi-cyan-fg">corrcoef</span><span class="ansi-blue-fg">(*args, **kwargs)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/numpy/lib/function_base.py:2845</span>, in <span class="ansi-cyan-fg">corrcoef</span><span class="ansi-blue-fg">(x, y, rowvar, bias, ddof, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">   2841</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> bias <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> np<span style="color: rgb(98,98,98)">.</span>_NoValue <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> ddof <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> np<span style="color: rgb(98,98,98)">.</span>_NoValue:
<span class="ansi-green-intense-fg ansi-bold">   2842</span>     <span style="color: rgb(95,135,135)"># 2015-03-15, 1.10</span>
<span class="ansi-green-intense-fg ansi-bold">   2843</span>     warnings<span style="color: rgb(98,98,98)">.</span>warn(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">bias and ddof have no effect and are deprecated</span><span style="color: rgb(175,0,0)">&#39;</span>,
<span class="ansi-green-intense-fg ansi-bold">   2844</span>                   <span class="ansi-bold" style="color: rgb(215,95,95)">DeprecationWarning</span>, stacklevel<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">3</span>)
<span class="ansi-green-fg">-&gt; 2845</span> c <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">cov</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">rowvar</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">dtype</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">dtype</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2846</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">   2847</span>     d <span style="color: rgb(98,98,98)">=</span> diag(c)

File <span class="ansi-green-fg">&lt;__array_function__ internals&gt;:180</span>, in <span class="ansi-cyan-fg">cov</span><span class="ansi-blue-fg">(*args, **kwargs)</span>

File <span class="ansi-green-fg">~/.local/lib/python3.8/site-packages/numpy/lib/function_base.py:2703</span>, in <span class="ansi-cyan-fg">cov</span><span class="ansi-blue-fg">(m, y, rowvar, bias, ddof, fweights, aweights, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">   2701</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   2702</span>     X_T <span style="color: rgb(98,98,98)">=</span> (X<span style="color: rgb(98,98,98)">*</span>w)<span style="color: rgb(98,98,98)">.</span>T
<span class="ansi-green-fg">-&gt; 2703</span> c <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">dot</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X_T</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">conj</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2704</span> c <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>true_divide(<span style="color: rgb(98,98,98)">1</span>, fact)
<span class="ansi-green-intense-fg ansi-bold">   2705</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> c<span style="color: rgb(98,98,98)">.</span>squeeze()

File <span class="ansi-green-fg">&lt;__array_function__ internals&gt;:180</span>, in <span class="ansi-cyan-fg">dot</span><span class="ansi-blue-fg">(*args, **kwargs)</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div><div class="panel panel-primary nbgrader_cell">
    <a name="cell-43bdb013d0e9bb1c"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-43bdb013d0e9bb1c</code></span>
  <span class="pull-right">
      Score: 0.0 / 1.0 <a href="#top">(Top)</a>
  </span></div>
    <div class="panel-body">
      <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best pipeline:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">### BEGIN HIDDEN TESTS</span>
<span class="n">best_k</span> <span class="o">=</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_k</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ColumnTransformer</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_k</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">SelectKBest</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_k</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ridge</span><span class="p">)</span>
<span class="c1">### END HIDDEN TESTS</span>
</pre></div>

      </div>
    </div>
    
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Best pipeline:
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Input <span class="ansi-green-fg">In [31]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 2&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Best pipeline:</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">----&gt; 2</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">grid_cv_k_best</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">best_estimator_</span><span style="color: rgb(98,98,98)">.</span>steps[<span style="color: rgb(98,98,98)">0</span>])
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(0,135,0)">print</span>(grid_cv_k_best<span style="color: rgb(98,98,98)">.</span>best_estimator_<span style="color: rgb(98,98,98)">.</span>steps[<span style="color: rgb(98,98,98)">1</span>])
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(0,135,0)">print</span>(grid_cv_k_best<span style="color: rgb(98,98,98)">.</span>best_estimator_<span style="color: rgb(98,98,98)">.</span>steps[<span style="color: rgb(98,98,98)">2</span>])

<span class="ansi-red-fg">AttributeError</span>: &#39;GridSearchCV&#39; object has no attribute &#39;best_estimator_&#39;</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ks</span><span class="p">)),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ks</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ks</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;number of features&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alphas</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal alpha  = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal number of features  = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal R2 score = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Input <span class="ansi-green-fg">In [32]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span> scores <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">grid_cv_k_best</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">cv_results_</span>[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">mean_test_score</span><span style="color: rgb(175,0,0)">&#39;</span>]
<span class="ansi-green-intense-fg ansi-bold">      2</span> heatmap <span style="color: rgb(98,98,98)">=</span> plt<span style="color: rgb(98,98,98)">.</span>pcolor(scores<span style="color: rgb(98,98,98)">.</span>reshape(<span style="color: rgb(0,135,0)">len</span>(alphas), <span style="color: rgb(0,135,0)">len</span>(ks)), cmap<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">RdYlGn</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">      3</span> plt<span style="color: rgb(98,98,98)">.</span>colorbar(heatmap)

<span class="ansi-red-fg">AttributeError</span>: &#39;GridSearchCV&#39; object has no attribute &#39;cv_results_&#39;</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div><div class="inner_cell">
    <div class="input_area">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># fit the best model and evaluate performance on test set</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">grid_cv_k_best</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">R2_tr</span><span class="p">,</span> <span class="n">R2_te</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">best_model</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_tr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test R2 = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">R2_te</span><span class="p">)</span>
</pre></div>

    </div>
  </div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Input <span class="ansi-green-fg">In [33]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 2&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># fit the best model and evaluate performance on test set</span>
<span class="ansi-green-fg">----&gt; 2</span> best_model <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">grid_cv_k_best</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">best_estimator_</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> R2_tr, R2_te <span style="color: rgb(98,98,98)">=</span> evaluate_model(best_model, X_tr, y_tr, X_te, y_te)
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Train R2 = </span><span class="ansi-bold" style="color: rgb(175,95,135)">%.2f</span><span style="color: rgb(175,0,0)">&#34;</span> <span style="color: rgb(98,98,98)">%</span> R2_tr)

<span class="ansi-red-fg">AttributeError</span>: &#39;GridSearchCV&#39; object has no attribute &#39;best_estimator_&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    </div>
  </div>
</body>

          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
